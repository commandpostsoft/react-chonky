"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("deepmerge"),t=require("react"),n=require("react-dnd"),r=require("react-dnd-html5-backend"),o=require("react-intl"),i=require("react-jss"),a=require("react-redux"),l=require("shortid"),c=require("@mui/material/styles"),s=require("@reduxjs/toolkit"),u=require("fast-sort"),d=require("fuzzy-search"),f=require("redux-watch"),p=require("filesize"),m=require("exact-trie"),h=require("@mui/material/useMediaQuery"),g=require("classnames"),y=require("@mui/material/Box"),b=require("@mui/material/ClickAwayListener"),v=require("hotkeys-js"),x=require("@mui/material/Breadcrumbs"),C=require("@mui/material/Button"),S=require("@mui/material/Menu"),I=require("@mui/material/ListItemIcon"),F=require("@mui/material/ListItemText"),k=require("@mui/material/MenuItem"),w=require("@mui/material/Typography"),E=require("@mui/material/InputAdornment"),D=require("@mui/material/TextField"),M=require("react-virtualized-auto-sizer"),N=require("react-window"),A=require("@mui/material/ListSubheader");function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function T(e,t,n,r,o,i,a){try{var l=e[i](a),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,o)}function z(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return O(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function L(){return L=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},L.apply(null,arguments)}function _(){_=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",l=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=Object.create((t&&t.prototype instanceof y?t:y).prototype),a=new N(r||[]);return o(i,"_invoke",{value:w(e,n,a)}),i}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var f="suspendedStart",p="suspendedYield",m="executing",h="completed",g={};function y(){}function b(){}function v(){}var x={};s(x,a,(function(){return this}));var C=Object.getPrototypeOf,S=C&&C(C(A([])));S&&S!==n&&r.call(S,a)&&(x=S);var I=v.prototype=y.prototype=Object.create(x);function F(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function n(o,i,a,l){var c=d(e[o],e,i);if("throw"!==c.type){var s=c.arg,u=s.value;return u&&"object"==typeof u&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,a,l)}),(function(e){n("throw",e,a,l)})):t.resolve(u).then((function(e){s.value=e,a(s)}),(function(e){return n("throw",e,a,l)}))}l(c.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function w(t,n,r){var o=f;return function(i,a){if(o===m)throw Error("Generator is already running");if(o===h){if("throw"===i)throw a;return{value:e,done:!0}}for(r.method=i,r.arg=a;;){var l=r.delegate;if(l){var c=E(l,r);if(c){if(c===g)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===f)throw o=h,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=m;var s=d(t,n,r);if("normal"===s.type){if(o=r.done?h:p,s.arg===g)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(o=h,r.method="throw",r.arg=s.arg)}}}function E(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,E(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var i=d(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,g;var a=i.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function D(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function M(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(D,this),this.reset(!0)}function A(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(typeof t+" is not iterable")}return b.prototype=v,o(I,"constructor",{value:v,configurable:!0}),o(v,"constructor",{value:b,configurable:!0}),b.displayName=s(v,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,v):(e.__proto__=v,s(e,c,"GeneratorFunction")),e.prototype=Object.create(I),e},t.awrap=function(e){return{__await:e}},F(k.prototype),s(k.prototype,l,(function(){return this})),t.AsyncIterator=k,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new k(u(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},F(I),s(I,c,"Generator"),s(I,a,(function(){return this})),s(I,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=A,N.prototype={constructor:N,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(M),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return l.type="throw",l.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],l=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),s=r.call(a,"finallyLoc");if(c&&s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!s)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),M(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;M(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:A(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}var R,P={},j=function(e){var n=t.useRef(P);return n.current===P&&(n.current=e()),n.current},H=function(e){var n=t.useRef(e);return t.useEffect((function(){n.current=e}),[n,e]),n},B=function(){function e(){}return e.error=function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=console).error.apply(e,["[Chonky runtime error]"].concat(n))},e.warn=function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=console).warn.apply(e,["[Chonky runtime warning]"].concat(n))},e.debug=function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=console).debug.apply(e,["[Chonky runtime debug]"].concat(n))},e.formatBullets=function(e){return"\n- "+e.join("\n- ")},e}(),V=function(){function e(){}return e.isDirectory=function(e){return!!e&&!0===e.isDir},e.isHidden=function(e){return!!e&&!0===e.isHidden},e.isSymlink=function(e){return!!e&&!0===e.isSymlink},e.isEncrypted=function(e){return!!e&&!0===e.isEncrypted},e.isClickable=function(e){return!!e},e.isOpenable=function(e){return!!e&&!1!==e.openable},e.isSelectable=function(e){return!!e&&!1!==e.selectable},e.isDraggable=function(e){return!!e&&!1!==e.draggable},e.isDroppable=function(e){return!(!e||(!e.isDir||!1===e.droppable)&&!0!==e.droppable)},e.isDndOpenable=function(t){return!(!e.isOpenable(t)||(!t.isDir||!1===t.dndOpenable)&&!0!==t.dndOpenable)},e.getModDate=function(t){return t&&null!=t.modDate?e.parseDate(t.modDate):null},e.parseDate=function(e){if("string"==typeof e||"number"==typeof e)try{return new Date(e)}catch(t){B.error("Could not convert provided string/number into a date: "+t.message+" ","Invalid value:",e)}return e instanceof Date&&!isNaN(e.getTime())?e:(B.warn("Unsupported date representation:",e),null)},e.getChildrenCount=function(e){return e&&"number"==typeof e.childrenCount?e.childrenCount:null},e}(),K=function(e,t){var n=[],r=[];if("folderChain"!==e&&"fileActions"!==e||t)if(Array.isArray(t)){for(var o=0,i=0,a=new Set,l=new Set,c=0;c<t.length;++c){var s=t[c];s?"object"!=typeof s?o++:!s.id||"fileActions"!==e&&!s.name?i++:a.has(s.id)?l.add(s.id):(a.add(s.id),n.push(s)):"fileActions"===e?o++:n.push(null)}if(o&&r.push("Detected "+o+' file(s) of invalid type. Remember that "files" array should contain either objects or nulls.'),i&&r.push("Detected "+i+' file(s) that are missing the required fields. Remember that file object should define an "id" and a "name".'),l.size>0){var u='"'+Array.from(l).join('", "')+'"';r.push("Detected "+l.size+" file IDs that are used multiple times. Remember that each file should have a unique IDs. The following IDs were seen multiple times: "+u)}}else r.push('Expected "'+e+'" prop to be an array, got "'+typeof t+'" instead.');if(r.length>0){var d,f,p="\n- "+r.join("\n- ");"folderChain"===e?(d="folder chain",f="files"):"fileActions"===e?(d="file actions",f="file actions"):(d="files",f="files"),B.error("Errors were detected when sanitizing the "+d+" array. Offending "+f+" were removed from the array. Summary of validation errors: "+p)}return{sanitizedArray:n,errorMessages:r}},q={ShowHiddenFiles:"show_hidden_files",ShowFoldersFirst:"show_folders_first",DarkMode:"dark_mode"};!function(e){e.ASC="asc",e.DESC="desc"}(R||(R={}));var G,W=function(e){return e.instanceId},U=function(e){return e.externalFileActionHandler},Y=function(e){return e.fileActionMap},X=function(e){return e.fileActionIds},Z=function(e){return function(t){return Y(t)[e]}},Q=function(e){return e.toolbarItems},$=function(e){return e.contextMenuItems},J=function(e){return e.folderChain},ee=function(e){var t=J(e);return t.length>0?t[t.length-1]:null},te=function(e){var t=J(e);return t.length>1?t[t.length-2]:null},ne=function(e){return e.fileMap},re=function(e){return e.cleanFileIds},oe=function(e){return function(t){return e?ne(t)[e]:null}},ie=function(e){return e.hiddenFileIdMap},ae=function(e){return Object.keys(ie(e)).length},le=function(e){return e.focusSearchInput},ce=function(e){return e.searchString},se=function(e){return e.selectionMap},ue=function(e){return Object.keys(se(e))},de=function(e){return ue(e).length},fe=function(e){return function(t){return!!e&&!!se(t)[e]}},pe=function(e){var t=ne(e);return Object.keys(se(e)).map((function(e){return t[e]}))},me=function(e){return function(t){var n=t.fileActionMap[e];if(n&&n.requiresSelection)return Ze(t,n.fileFilter)}},he=function(e){return function(t){var n;return null==(n=Qe(t,e))?void 0:n.length}},ge=function(e){return e.disableSelection},ye=function(e){return e.forceEnableOpenParent},be=function(e){return e.hideToolbarInfo},ve=function(e){return e.fileViewConfig},xe=function(e){return e.sortActionId},Ce=function(e){return e.sortOrder},Se=function(e){return e.optionMap},Ie=function(e){return function(t){return Se(t)[e]}},Fe=function(e){return e.thumbnailGenerator},ke=function(e){return e.doubleClickDelay},we=function(e){return e.disableDragAndDrop},Ee=function(e){return e.clearSelectionOnOutsideClick},De=function(e){return e.contextMenuMounted},Me=function(e){return e.contextMenuConfig},Ne=function(e){var t,n=Me(e);return n&&n.triggerFileId&&null!=(t=ne(e)[n.triggerFileId])?t:null},Ae=function(e){return e.fileActionMap},Oe=function(e){return e.optionMap},Te=function(e){return e.fileMap},ze=function(e){return e.fileIds},Le=function(e){return e.cleanFileIds},_e=function(e){return e.sortActionId},Re=function(e){return e.sortOrder},Pe=function(e){return e.searchString},je=function(e){return e.lastClick},He=function(e){return s.createSelector([Ae,e],(function(e,t){return t&&e[t]?e[t]:null}))},Be=function(e,t){return void 0===t&&(t=void 0),s.createSelector([Oe],(function(n){var r=n[e];return void 0===r?t:r}))},Ve=function(e){return s.createSelector([Te,e],(function(e,t){return t.map((function(t){return t&&e[t]?e[t]:null}))}))},Ke=s.createSelector([ze,Re,Ve(ze),He(_e),Be(q.ShowFoldersFirst,!1)],(function(e,t,n,r,o){if(!r)return e;var i,a=function(e){return function(t){return e(t)}},l=[];return o&&l.push({desc:a(V.isDirectory)}),r.sortKeySelector&&l.push(((i={})[t===R.ASC?"asc":"desc"]=a(r.sortKeySelector),i)),0===l.length?e:u.sort([].concat(n)).by(l).map((function(e){return e?e.id:null}))})),qe=s.createSelector([Ve(Le)],(function(e){return new d(e,["name"],{caseSensitive:!1})})),Ge=s.createSelector([Le,Pe,qe],(function(e,t,n){return t?n.search(t).map((function(e){return e.id})):e})),We=s.createSelector([Ge,Ve(Le),Be(q.ShowHiddenFiles)],(function(e,t,n){var r=new Set(e),o={};return t.forEach((function(e){e&&(r.has(e.id)?!n&&V.isHidden(e)&&(o[e.id]=!0):o[e.id]=!0)})),o})),Ue={getFileActionMap:Ae,getOptionMap:Oe,getFileMap:Te,getFileIds:ze,getCleanFileIds:Le,getSortActionId:_e,getSortOrder:Re,getSearchString:Pe,_getLastClick:je,getSortedFileIds:Ke,getSearcher:qe,getSearchFilteredFileIds:Ge,getHiddenFileIdMap:We,getDisplayFileIds:s.createSelector([Ke,We],(function(e,t){return e.filter((function(e){return!e||!t[e]}))})),getLastClickIndex:s.createSelector([je,Ke],(function(e,t){return!e||e.index>t.length-1||e.fileId!=t[e.index]?null:e.index})),makeGetAction:He,makeGetOptionValue:Be,makeGetFiles:Ve},Ye=function(e,t){return t?ne(e)[t]:null},Xe=function(e,t){return!!se(e)[t.id]},Ze=function(e){for(var t=e.fileMap,n=Object.keys(e.selectionMap).map((function(e){return t[e]})),r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return o.reduce((function(e,t){return t?e.filter(t):e}),n)},Qe=function(e,t){return me(t)(e)};exports.ChonkyIconName=void 0,(G=exports.ChonkyIconName||(exports.ChonkyIconName={})).loading="loading",G.dropdown="dropdown",G.placeholder="placeholder",G.dndDragging="dndDragging",G.dndCanDrop="dndCanDrop",G.dndCannotDrop="dndCannotDrop",G.openFiles="openFiles",G.openParentFolder="openParentFolder",G.copy="copy",G.paste="paste",G.share="share",G.search="search",G.selectAllFiles="selectAllFiles",G.clearSelection="clearSelection",G.sortAsc="sortAsc",G.sortDesc="sortDesc",G.toggleOn="toggleOn",G.toggleOff="toggleOff",G.list="list",G.compact="compact",G.smallThumbnail="smallThumbnail",G.largeThumbnail="largeThumbnail",G.folder="folder",G.folderCreate="folderCreate",G.folderOpen="folderOpen",G.folderChainSeparator="folderChainSeparator",G.download="download",G.upload="upload",G.trash="trash",G.fallbackIcon="fallbackIcon",G.symlink="symlink",G.hidden="hidden",G.file="file",G.license="license",G.code="code",G.config="config",G.model="model",G.database="database",G.text="text",G.archive="archive",G.image="image",G.video="video",G.info="info",G.key="key",G.lock="lock",G.music="music",G.terminal="terminal",G.users="users",G.linux="linux",G.ubuntu="ubuntu",G.windows="windows",G.rust="rust",G.python="python",G.nodejs="nodejs",G.php="php",G.git="git",G.pdf="pdf",G.excel="excel",G.word="word",G.flash="flash";var $e,Je=function(e,t){return function(n){var r,o=K("fileActions",e),i=o.sanitizedArray,a=o.errorMessages;if(Array.isArray(t)){var l=new Set(t);r=ht.filter((function(e){return!l.has(e.id)}))}else r=t?[]:ht;var c=function(){for(var e,t=new Set,n=function(e){return!!t.add(e.id)},r=function(e){return!t.has(e.id)},o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var l=i.map((function(e){var t=e.filter(r);return t.map(n),t}));return(e=new Array).concat.apply(e,l)}(i,mt,r),s={};c.map((function(e){return e.option?s[e.option.id]=e.option.defaultValue:null})),n(vt.setRawFileActions(e)),n(vt.setFileActionsErrorMessages(a)),n(vt.setFileActions(c)),n(vt.setOptionDefaults(s)),n(et(c))}},et=function(e){return function(t){for(var n,r=new Set([pt.OpenParentFolder.id]),o={Actions:exports.ChonkyIconName.dropdown,Options:exports.ChonkyIconName.config},i={Options:0,Actions:1},a=[],l=[],c={},s=[],u={},d=function(e,t,n){if(t[n])return t[n];var r={name:n,icon:o[n]||null,sortOrder:i[n]||-1,fileActionIds:[]};return e.push(r),t[n]=r,r},f=z(e);!(n=f()).done;){var p=n.value,m=p.button;m&&(m.toolbar&&!r.has(p.id)&&(m.group?d(l,c,m.group).fileActionIds.push(p.id):a.push(p.id)),m.contextMenu&&(m.group?d(s,u,m.group).fileActionIds.push(p.id):s.push(p.id)))}l.sort((function(e,t){return e.sortOrder-t.sortOrder})),t(vt.updateFileActionMenuItems([[].concat(a,l),s]))}},tt=function(e){return function(t,n){var r=n(),o=e?r.fileActionMap[e]:null;o&&o.fileViewConfig&&t(vt.setFileViewConfig(o.fileViewConfig))}},nt=function(e){return function(t,n){if(e){var r=n(),o=r.fileActionMap[e];if(o&&o.sortKeySelector){var i=r.sortOrder===R.ASC?R.DESC:R.ASC;r.sortActionId!==e&&(i=R.ASC),t(vt.setSort({actionId:e,order:i}))}}}},rt=function(e){return function(t,n){B.debug("FILE ACTION DISPATCH: ["+e.id+"]","data:",e);var r=n(),o=Y(r)[e.id],i=U(r);o?i&&Promise.resolve(i(e)).catch((function(e){return B.error("User-defined file action handler threw an error: "+e.message)})):B.warn('Internal components dispatched the "'+e.id+'" file action, but such action was not registered.')}},ot=function(e,t){return function(n,r){B.debug("FILE ACTION REQUEST: ["+e.id+"]","action:",e,"payload:",t);var o=r(),i=W(o);Y(o)[e.id]||B.warn('The action "'+e.id+'" was requested, but it is not registered. The action will still be dispatched, but this might indicate a bug in the code. Please register your actions by passing them to "fileActions" prop.');var a=pe(o),l=e.fileFilter?a.filter(e.fileFilter):a;if(!e.requiresSelection||0!==l.length){var c={instanceId:i,selectedFiles:a,selectedFilesForAction:l,contextMenuTriggerFile:Ne(o)};e.sortKeySelector&&n(nt(e.id));var s=e.fileViewConfig;s&&n(vt.setFileViewConfig(s));var u=e.option;u&&n(vt.toggleOption(u.id)),e.selectionTransform&&n(function(e){return function(t,n){var r=e.selectionTransform;if(r){var o=n(),i=new Set(Object.keys(se(o))),a=new Set(Object.keys(ie(o))),l=r({prevSelection:i,fileIds:re(o),fileMap:ne(o),hiddenFileIds:a});l&&t(0===l.size?vt.clearSelection():vt.selectFiles({fileIds:Array.from(l),reset:!0}))}}}(e));var d=e.effect,f=void 0;if(d)try{f=d({action:e,payload:t,state:c,reduxDispatch:n,getReduxState:r})}catch(t){B.error("User-defined effect function for action "+e.id+" threw an error: "+t.message)}return Promise.resolve(f).then((function(r){it(n,{id:e.id,action:e,payload:t,state:c},r)})).catch((function(r){B.error("User-defined effect function for action "+e.id+" returned a promise that was rejected: "+r.message),it(n,{id:e.id,action:e,payload:t,state:c},void 0)}))}B.warn('Internal components requested the "'+e.id+'" file action, but the selection for this action was empty. This might a bug in the code of the presentational components.')}},it=function(e,t,n){!0===n||e(rt(t))};exports.FileViewMode=void 0,($e=exports.FileViewMode||(exports.FileViewMode={})).List="list",$e.Compact="compact",$e.Grid="grid";var at,lt=function(e,t){if(void 0!==e.__payloadType&&(e.hotkeys||e.button)){var n='Invalid definition was provided for file action "'+e.id+'". Actions that specify hotkeys or buttons cannot define a payload type. If your application requires this functionality, define two actions and chain them using effects.';throw B.error(n),new Error(n)}return e.effect=t,e},ct=function e(t,n){return t?n(t)?t:t.parentElement?e(t.parentElement,n):null:t},st=function(e,t,n){return n?typeof e===n?e:t:void 0!==e?e:t},ut={MouseClickFile:lt({id:"mouse_click_file",__payloadType:{}},(function(e){var t,n=e.payload,r=e.reduxDispatch,o=e.getReduxState;if("double"===n.clickType)V.isOpenable(n.file)&&r(ot(pt.OpenFiles,{targetFile:n.file,files:[n.file]}));else{var i=ge(o());if(V.isSelectable(n.file)&&!i)if(n.ctrlKey)r(vt.toggleSelection({fileId:n.file.id,exclusive:!1})),r(vt.setLastClickIndex({index:n.fileDisplayIndex,fileId:n.file.id}));else if(n.shiftKey){var a=Ue.getLastClickIndex(o());if("number"==typeof a){var l=a,c=n.fileDisplayIndex;if(l>c){var s=[c,l];l=s[0],c=s[1]}r((t={rangeStart:l,rangeEnd:c},function(e,n){var r=n();if(!r.disableSelection){var o=Ue.getDisplayFileIds(r).slice(t.rangeStart,t.rangeEnd+1).filter((function(e){return e&&V.isSelectable(r.fileMap[e])}));e(vt.selectFiles({fileIds:o,reset:!!t.reset}))}}))}else r(vt.toggleSelection({fileId:n.file.id,exclusive:!1})),r(vt.setLastClickIndex({index:n.fileDisplayIndex,fileId:n.file.id}))}else r(vt.toggleSelection({fileId:n.file.id,exclusive:!0})),r(vt.setLastClickIndex({index:n.fileDisplayIndex,fileId:n.file.id}));else n.ctrlKey||i||r(vt.clearSelection()),r(vt.setLastClickIndex({index:n.fileDisplayIndex,fileId:n.file.id}))}})),KeyboardClickFile:lt({id:"keyboard_click_file",__payloadType:{}},(function(e){var t=e.payload,n=e.reduxDispatch,r=e.getReduxState;n(vt.setLastClickIndex({index:t.fileDisplayIndex,fileId:t.file.id})),t.enterKey?0===de(r())&&n(ot(pt.OpenFiles,{targetFile:t.file,files:[t.file]})):t.spaceKey&&V.isSelectable(t.file)&&n(vt.toggleSelection({fileId:t.file.id,exclusive:t.ctrlKey}))})),StartDragNDrop:lt({id:"start_drag_n_drop",__payloadType:{}},(function(e){var t=e.reduxDispatch,n=e.payload.draggedFile;Xe((0,e.getReduxState)(),n)||V.isSelectable(n)&&t(vt.selectFiles({fileIds:[n.id],reset:!0}))})),EndDragNDrop:lt({id:"end_drag_n_drop",__payloadType:{}},(function(e){var t=e.payload,n=e.reduxDispatch;if(!Xe((0,e.getReduxState)(),t.destination)){var r=t.selectedFiles;n(ot(pt.MoveFiles,L({},t,{files:r.length>0?r:[t.draggedFile]})))}})),MoveFiles:lt({id:"move_files",__payloadType:{}}),ChangeSelection:lt({id:"change_selection",__payloadType:{}}),OpenFiles:lt({id:"open_files",__payloadType:{}}),OpenParentFolder:lt({id:"open_parent_folder",hotkeys:["backspace"],button:{name:"Go up a directory",toolbar:!0,contextMenu:!1,icon:exports.ChonkyIconName.openParentFolder,iconOnly:!0}},(function(e){var t=e.reduxDispatch,n=(0,e.getReduxState)(),r=te(n);V.isOpenable(r)?t(ot(pt.OpenFiles,{targetFile:r,files:[r]})):n.forceEnableOpenParent||B.warn("Open parent folder effect was triggered even though the parent folder is not openable. This indicates a bug in presentation components.")})),OpenFileContextMenu:lt({id:"open_file_context_menu",__payloadType:{}},(function(e){var t=e.payload,n=e.reduxDispatch,r=e.getReduxState,o=Ye(r(),t.triggerFileId);o&&(Xe(r(),o)||(V.isSelectable(o)?n(vt.selectFiles({fileIds:[t.triggerFileId],reset:!0})):n(vt.clearSelection()))),n(vt.showContextMenu({triggerFileId:t.triggerFileId,mouseX:t.clientX-2,mouseY:t.clientY-4}))}))},dt={OpenSelection:lt({id:"open_selection",hotkeys:["enter"],requiresSelection:!0,fileFilter:V.isOpenable,button:{name:"Open selection",toolbar:!0,contextMenu:!0,group:"Actions",icon:exports.ChonkyIconName.openFiles}},(function(e){(0,e.reduxDispatch)(ot(ut.OpenFiles,{files:e.state.selectedFilesForAction}))})),SelectAllFiles:lt({id:"select_all_files",hotkeys:["ctrl+a"],button:{name:"Select all files",toolbar:!0,contextMenu:!0,group:"Actions",icon:exports.ChonkyIconName.selectAllFiles},selectionTransform:function(e){var t=e.fileIds,n=e.hiddenFileIds,r=new Set;return t.map((function(e){n.has(e)||r.add(e)})),r}}),ClearSelection:lt({id:"clear_selection",hotkeys:["escape"],button:{name:"Clear selection",toolbar:!0,contextMenu:!0,group:"Actions",icon:exports.ChonkyIconName.clearSelection},selectionTransform:function(e){return 0===e.prevSelection.size?null:new Set}}),EnableListView:lt({id:"enable_list_view",fileViewConfig:{mode:exports.FileViewMode.List,entryHeight:30},button:{name:"Switch to List",toolbar:!0,icon:exports.ChonkyIconName.list,group:"Options"}}),EnableCompactView:lt({id:"enable_compact_view",fileViewConfig:{mode:exports.FileViewMode.Compact,entryHeight:40,entryWidth:220},button:{name:"Switch to Compact",toolbar:!0,icon:exports.ChonkyIconName.compact,group:"Options"}}),EnableGridView:lt({id:"enable_grid_view",fileViewConfig:{mode:exports.FileViewMode.Grid,entryWidth:100,entryHeight:100},button:{name:"Switch to Grid",toolbar:!0,icon:exports.ChonkyIconName.smallThumbnail,group:"Options"}}),SortFilesByName:lt({id:"sort_files_by_name",sortKeySelector:function(e){return e?e.name.toLowerCase():void 0},button:{name:"Sort by name",toolbar:!0,group:"Options"}}),SortFilesBySize:lt({id:"sort_files_by_size",sortKeySelector:function(e){return e?e.size:void 0},button:{name:"Sort by size",toolbar:!0,group:"Options"}}),SortFilesByDate:lt({id:"sort_files_by_date",sortKeySelector:function(e){return e?e.modDate:void 0},button:{name:"Sort by date",toolbar:!0,group:"Options"}}),ToggleHiddenFiles:lt({id:"toggle_hidden_files",hotkeys:["ctrl+h"],option:{id:q.ShowHiddenFiles,defaultValue:!0},button:{name:"Show hidden files",toolbar:!0,group:"Options"}}),ToggleShowFoldersFirst:lt({id:"toggle_show_folders_first",option:{id:q.ShowFoldersFirst,defaultValue:!0},button:{name:"Show folders first",toolbar:!0,group:"Options"}}),FocusSearchInput:lt({id:"focus_search_input",hotkeys:["ctrl+f"]},(function(e){var t=le((0,e.getReduxState)());t&&t()})),ToggleDarkMode:lt({id:"enable_dark_mode",option:{id:q.DarkMode,defaultValue:!1},button:{name:"Enable dark mode",toolbar:!0,icon:exports.ChonkyIconName.list,iconOnly:!0}})},ft={CopyFiles:lt({id:"copy_files",requiresSelection:!0,hotkeys:["ctrl+c"],button:{name:"Copy selection",toolbar:!0,contextMenu:!0,group:"Actions",icon:exports.ChonkyIconName.copy}}),CreateFolder:lt({id:"create_folder",button:{name:"Create folder",toolbar:!0,tooltip:"Create a folder",icon:exports.ChonkyIconName.folderCreate}}),UploadFiles:lt({id:"upload_files",button:{name:"Upload files",toolbar:!0,tooltip:"Upload files",icon:exports.ChonkyIconName.upload}}),DownloadFiles:lt({id:"download_files",requiresSelection:!0,button:{name:"Download files",toolbar:!0,contextMenu:!0,group:"Actions",icon:exports.ChonkyIconName.download}}),DeleteFiles:lt({id:"delete_files",requiresSelection:!0,hotkeys:["delete"],button:{name:"Delete files",toolbar:!0,contextMenu:!0,group:"Actions",icon:exports.ChonkyIconName.trash}})},pt=L({},ut,dt,ft),mt=[pt.MouseClickFile,pt.KeyboardClickFile,pt.StartDragNDrop,pt.EndDragNDrop,pt.MoveFiles,pt.ChangeSelection,pt.OpenFiles,pt.OpenParentFolder,pt.OpenFileContextMenu],ht=[pt.OpenSelection,pt.SelectAllFiles,pt.ClearSelection,pt.EnableListView,pt.EnableGridView,pt.SortFilesByName,pt.SortFilesBySize,pt.SortFilesByDate,pt.ToggleHiddenFiles,pt.ToggleShowFoldersFirst,pt.FocusSearchInput],gt={instanceId:"CHONKY_INVALID_ID",externalFileActionHandler:null,rawFileActions:[],fileActionsErrorMessages:[],fileActionMap:{},fileActionIds:[],toolbarItems:[],contextMenuItems:[],rawFolderChain:null,folderChainErrorMessages:[],folderChain:[],rawFiles:[],filesErrorMessages:[],fileMap:{},fileIds:[],cleanFileIds:[],sortedFileIds:[],hiddenFileIdMap:{},focusSearchInput:null,searchString:"",searchMode:"currentFolder",selectionMap:{},disableSelection:!1,fileViewConfig:pt.EnableGridView.fileViewConfig,sortActionId:null,sortOrder:R.ASC,optionMap:{},thumbnailGenerator:null,doubleClickDelay:300,disableDragAndDrop:!1,clearSelectionOnOutsideClick:!0,forceEnableOpenParent:!1,hideToolbarInfo:!1,lastClick:null,contextMenuMounted:!1,contextMenuConfig:null},yt={setExternalFileActionHandler:function(e,t){var n;e.externalFileActionHandler=null!=(n=t.payload)?n:null},setRawFileActions:function(e,t){e.rawFileActions=t.payload},setFileActionsErrorMessages:function(e,t){e.fileActionsErrorMessages=t.payload},setFileActions:function(e,t){var n={};t.payload.map((function(e){return n[e.id]=e}));var r=t.payload.map((function(e){return e.id}));e.fileActionMap=n,e.fileActionIds=r},updateFileActionMenuItems:function(e,t){var n=t.payload;e.toolbarItems=n[0],e.contextMenuItems=n[1]},setRawFolderChain:function(e,t){var n=t.payload,r=K("folderChain",n),o=r.sanitizedArray,i=r.errorMessages;e.rawFolderChain=n,e.folderChain=o,e.folderChainErrorMessages=i},setRawFiles:function(e,t){var n=t.payload,r=K("files",n),o=r.sanitizedArray,i=r.errorMessages;e.rawFiles=n,e.filesErrorMessages=i;var a={};o.forEach((function(e){e&&(a[e.id]=e)}));var l=o.map((function(e){return e?e.id:null})),c=l.filter((function(e){return!!e}));e.fileMap=a,e.fileIds=l,e.cleanFileIds=c;for(var s=0,u=Object.keys(e.selectionMap);s<u.length;s++){var d=u[s];a[d]||delete e.selectionMap[d]}},setSortedFileIds:function(e,t){e.sortedFileIds=t.payload},setHiddenFileIds:function(e,t){e.hiddenFileIdMap=t.payload;for(var n=0,r=Object.keys(e.selectionMap);n<r.length;n++){var o=r[n];e.hiddenFileIdMap[o]&&delete e.selectionMap[o]}},setFocusSearchInput:function(e,t){e.focusSearchInput=t.payload},setSearchString:function(e,t){e.searchString=t.payload},selectAllFiles:function(e){e.fileIds.filter((function(t){return t&&V.isSelectable(e.fileMap[t])})).map((function(t){return t?e.selectionMap[t]=!0:null}))},selectFiles:function(e,t){e.disableSelection||(t.payload.reset&&(e.selectionMap={}),t.payload.fileIds.filter((function(t){return t&&V.isSelectable(e.fileMap[t])})).map((function(t){return e.selectionMap[t]=!0})))},toggleSelection:function(e,t){if(!e.disableSelection){var n=!!e.selectionMap[t.payload.fileId];t.payload.exclusive&&(e.selectionMap={}),n?delete e.selectionMap[t.payload.fileId]:V.isSelectable(e.fileMap[t.payload.fileId])&&(e.selectionMap[t.payload.fileId]=!0)}},clearSelection:function(e){e.disableSelection||0!==Object.keys(e.selectionMap).length&&(e.selectionMap={})},setSelectionDisabled:function(e,t){e.disableSelection=t.payload,0!==Object.keys(e.selectionMap).length&&(e.selectionMap={})},setFileViewConfig:function(e,t){e.fileViewConfig=t.payload},setSort:function(e,t){e.sortActionId=t.payload.actionId,e.sortOrder=t.payload.order},setOptionDefaults:function(e,t){for(var n=0,r=Object.keys(t.payload);n<r.length;n++){var o=r[n];o in e.optionMap||(e.optionMap[o]=t.payload[o])}},toggleOption:function(e,t){e.optionMap[t.payload]=!e.optionMap[t.payload]},setThumbnailGenerator:function(e,t){e.thumbnailGenerator=t.payload},setDoubleClickDelay:function(e,t){e.doubleClickDelay=t.payload},setDisableDragAndDrop:function(e,t){e.disableDragAndDrop=t.payload},setForceEnableOpenParent:function(e,t){e.forceEnableOpenParent=t.payload},setHideToolbarInfo:function(e,t){e.hideToolbarInfo=t.payload},setClearSelectionOnOutsideClick:function(e,t){e.clearSelectionOnOutsideClick=t.payload},setLastClickIndex:function(e,t){e.lastClick=t.payload},setContextMenuMounted:function(e,t){e.contextMenuMounted=t.payload},showContextMenu:function(e,t){e.contextMenuConfig=t.payload},hideContextMenu:function(e){e.contextMenuConfig&&(e.contextMenuConfig=null)}},bt=s.createSlice({name:"root",initialState:gt,reducers:yt}),vt=bt.actions,xt=bt.reducer,Ct=function(e){var n=j((function(){var t=L({},gt,{instanceId:e});return s.configureStore({preloadedState:t,reducer:xt,middleware:function(e){return e({serializableCheck:!1})},devTools:{name:"chonky_"+e}})}));return function(e){t.useEffect((function(){var t=f((function(){return se(e.getState())})),n=[e.subscribe(t((function(t,n){if(t!==n){var r=ue(e.getState()),o=new Set(r);e.dispatch(ot(pt.ChangeSelection,{selection:o}))}})))];return function(){for(var e=0,t=n;e<t.length;e++)(0,t[e])()}}),[e])}(n),n},St=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=t.useCallback((function(t){return e.apply(void 0,r)(t)}),[e].concat(r));return a.useSelector(i)},It=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=a.useDispatch();t.useEffect((function(){i(e.apply(void 0,r))}),[i,e].concat(r))},Ft=function(e,n){var r=a.useDispatch();t.useEffect((function(){r(e(n))}),[r,e,n])},kt=function(){return t.createElement("span",{title:"No icon component found. Please follow Chonky installation instructions to provide a pre-made icon component (or a custom icon)."},"⚠️")},wt={fileActions:null,onFileAction:null,thumbnailGenerator:null,doubleClickDelay:300,disableSelection:!1,disableDefaultFileActions:!1,forceEnableOpenParent:!1,hideToolbarInfo:!1,disableDragAndDrop:!1,disableDragAndDropProvider:!1,defaultSortActionId:pt.SortFilesByName.id,defaultFileViewActionId:pt.EnableListView.id,clearSelectionOnOutsideClick:!0,iconComponent:kt,darkMode:!1,i18n:{}};exports.I18nNamespace=void 0,(at=exports.I18nNamespace||(exports.I18nNamespace={})).Toolbar="toolbar",at.FileList="fileList",at.FileEntry="fileEntry",at.FileContextMenu="contextMenu",at.FileActions="actions",at.FileActionGroups="actionGroups";var Et=function(e,t){return"chonky."+e+"."+t},Dt=function(e,t){return"chonky."+exports.I18nNamespace.FileActions+"."+e+"."+t},Mt=function(e){var n=o.useIntl();return t.useMemo((function(){var t,r;if(!e)return{buttonName:"",buttonTooltip:void 0};var o,i=n.formatMessage({id:Dt(e.id,"button.name"),defaultMessage:null==(t=e.button)?void 0:t.name}),a=void 0;return null!=(r=e.button)&&r.tooltip&&(a=n.formatMessage({id:Dt(e.id,"button.tooltip"),defaultMessage:null==(o=e.button)?void 0:o.tooltip})),{buttonName:i,buttonTooltip:a}}),[e,n])},Nt=function(e){var n=o.useIntl(),r=t.useContext(Ot);return t.useMemo((function(){return{fileModDateString:r.formatFileModDate(n,e),fileSizeString:r.formatFileSize(n,e)}}),[e,r,n])},At={formatFileModDate:function(e,t){var n=V.getModDate(t);return n?e.formatDate(n):null},formatFileSize:function(e,t){if(!t||"number"!=typeof t.size)return null;var n=p.filesize(t.size,{bits:!1,output:"object"});return"B"===n.symbol?Math.round(n.value/10)/100+" KB":"KB"===n.symbol?Math.round(n.value)+" "+n.symbol:n.value+" "+n.symbol}},Ot=t.createContext(At),Tt=t.createContext(kt),zt=["3g2","3gp","3gpp","asf","asx","avi","dvb","f4v","fli","flv","fvt","h261","h263","h264","jpgm","jpgv","jpm","m1v","m2v","m4u","m4v","mj2","mjp2","mk3d","mks","mkv","mng","mov","movie","mp4","mp4v","mpe","mpeg","mpg","mpg4","mxu","ogv","pyv","qt","smv","ts","uvh","uvm","uvp","uvs","uvu","uvv","uvvh","uvvm","uvvp","uvvs","uvvu","uvvv","viv","vob","webm","wm","wmv","wmx","wvx"],Lt=["3ds","apng","azv","bmp","bmp","btif","cgm","cmx","djv","djvu","drle","dwg","dxf","emf","exr","fbs","fh","fh4","fh5","fh7","fhc","fits","fpx","fst","g3","gif","heic","heics","heif","heifs","ico","ico","ief","jls","jng","jp2","jpe","jpeg","jpf","jpg","jpg2","jpm","jpx","jxr","ktx","mdi","mmr","npx","pbm","pct","pcx","pcx","pgm","pic","png","pnm","ppm","psd","pti","ras","rgb","rlc","sgi","sid","sub","svg","svgz","t38","tap","tfx","tga","tif","tiff","uvg","uvi","uvvg","uvvi","vtf","wbmp","wdp","webp","wmf","xbm","xif","xpm","xwd"],_t=["3gpp","aac","adp","aif","aifc","aiff","au","caf","dra","dts","dtshd","ecelp4800","ecelp7470","ecelp9600","eol","flac","kar","lvp","m2a","m3a","m3u","m4a","m4a","mid","midi","mka","mp2","mp2a","mp3","mp3","mp4a","mpga","oga","ogg","pya","ra","ra","ram","rip","rmi","rmp","s3m","sil","snd","spx","uva","uvva","wav","wav","wav","wax","weba","wma","xm"],Rt=["#bbbbbb","#d65c5c","#d6665c","#d6705c","#d67a5c","#d6855c","#d68f5c","#d6995c","#d6a35c","#d6ad5c","#d6b85c","#d6c25c","#d6cc5c","#d6d65c","#ccd65c","#c2d65c","#b8d65c","#add65c","#a3d65c","#99d65c","#8fd65c","#85d65c","#7ad65c","#70d65c","#66d65c","#5cd65c","#5cd666","#5cd670","#5cd67a","#5cd685","#5cd68f","#5cd699","#5cd6a3","#5cd6ad","#5cd6b8","#5cd6c2","#5cd6cc","#5cd6d6","#5cccd6","#5cc2d6","#5cb8d6","#5cadd6","#5ca3d6","#5c99d6","#5c8fd6","#5c85d6","#5c7ad6","#5c70d6","#5c66d6","#5c5cd6","#665cd6","#705cd6","#7a5cd6","#855cd6","#8f5cd6","#995cd6","#a35cd6","#ad5cd6","#b85cd6","#c25cd6","#cc5cd6","#d65cd6","#d65ccc","#d65cc2","#d65cb8","#d65cad","#d65ca3","#d65c99","#d65c8f","#d65c85","#d65c7a","#d65c70","#d65c66"],Pt=["#777","#8f3d3d","#8f443d","#8f4b3d","#8f523d","#8f583d","#8f5f3d","#8f663d","#8f6d3d","#8f743d","#8f7a3d","#8f813d","#8f883d","#8f8f3d","#888f3d","#818f3d","#7a8f3d","#748f3d","#6d8f3d","#668f3d","#5f8f3d","#588f3d","#528f3d","#4b8f3d","#448f3d","#3d8f3d","#3d8f44","#3d8f4b","#3d8f52","#3d8f58","#3d8f5f","#3d8f66","#3d8f6d","#3d8f74","#3d8f7a","#3d8f81","#3d8f88","#3d8f8f","#3d888f","#3d818f","#3d7a8f","#3d748f","#3d6d8f","#3d668f","#3d5f8f","#3d588f","#3d528f","#3d4b8f","#3d448f","#3d3d8f","#443d8f","#4b3d8f","#523d8f","#583d8f","#5f3d8f","#663d8f","#6d3d8f","#743d8f","#7a3d8f","#813d8f","#883d8f","#8f3d8f","#8f3d88","#8f3d81","#8f3d7a","#8f3d74","#8f3d6d","#8f3d66","#8f3d5f","#8f3d58","#8f3d52","#8f3d4b","#8f3d44"],jt=function(){for(var e=0,t=[[exports.ChonkyIconName.license,["license"]],[exports.ChonkyIconName.config,["sfk","ini","yml","toml","iml"]],[exports.ChonkyIconName.model,["3ds","obj","ply","fbx"]],[exports.ChonkyIconName.database,["csv","json","sql","sqlite","sqlite3","npy","npz","rec","idx","hdf5"]],[exports.ChonkyIconName.text,["txt","md","mdx"]],[exports.ChonkyIconName.archive,["zip","rar","tar","tar.gz","7z"]],[exports.ChonkyIconName.image,Lt],[exports.ChonkyIconName.video,zt],[exports.ChonkyIconName.code,["html","php","css","sass","scss","less","cpp","h","hpp","c","xml"]],[exports.ChonkyIconName.info,["bib","readme","nfo"]],[exports.ChonkyIconName.key,["pem","pub"]],[exports.ChonkyIconName.lock,["lock","lock.json","shrinkwrap.json"]],[exports.ChonkyIconName.music,_t],[exports.ChonkyIconName.terminal,["run","sh"]],[exports.ChonkyIconName.trash,[".Trashes"]],[exports.ChonkyIconName.users,["authors","contributors"]],[exports.ChonkyIconName.linux,["AppImage"]],[exports.ChonkyIconName.ubuntu,["deb"]],[exports.ChonkyIconName.windows,["exe"]],[exports.ChonkyIconName.rust,["rs","rlib"]],[exports.ChonkyIconName.python,["py","ipynb"]],[exports.ChonkyIconName.nodejs,["js","jsx","ts","tsx","d.ts"]],[exports.ChonkyIconName.php,["php"]],[exports.ChonkyIconName.git,[".gitignore"]],[exports.ChonkyIconName.pdf,["pdf"]],[exports.ChonkyIconName.excel,["xls","xlsx"]],[exports.ChonkyIconName.word,["doc","docx","odt"]],[exports.ChonkyIconName.flash,["swf"]]],n=new m({ignoreCase:!0}),r=0,o=t;r<o.length;r++)for(var i=o[r],a=i[0],l=i[1],c=0;c<l.length;++c)n.put(l[c],{icon:a,colorCode:(e+=5)%(Rt.length-1)+1},!0);return n}(),Ht={colors:{debugRed:"#fabdbd",debugBlue:"#bdd8fa",debugGreen:"#d2fabd",debugPurple:"#d2bdfa",debugYellow:"#fae9bd",textActive:"#09f"},fontSizes:{rootPrimary:15},margins:{rootLayoutMargin:8},root:{borderRadius:4,borderStyle:"solid 1px",height:"100%"},toolbar:{size:30,lineHeight:"30px",buttonPadding:8,fontSize:15,buttonRadius:4},dnd:{canDropColor:"green",cannotDropColor:"red",canDropMask:"rgba(180, 235, 180, 0.75)",cannotDropMask:"rgba(235, 180, 180, 0.75)",fileListCanDropMaskOne:"rgba(180, 235, 180, 0.1)",fileListCanDropMaskTwo:"rgba(180, 235, 180, 0.2)",fileListCannotDropMaskOne:"rgba(235, 180, 180, 0.1)",fileListCannotDropMaskTwo:"rgba(235, 180, 180, 0.2)"},dragLayer:{border:"solid 2px #09f",padding:"7px 10px",borderRadius:2},fileList:{desktopGridGutter:8,mobileGridGutter:5},gridFileEntry:{childrenCountSize:"1.6em",iconColorFocused:"#000",iconSize:"2.4em",iconColor:"#fff",borderRadius:5,fontSize:14,fileColorTint:"rgba(255, 255, 255, 0.4)",folderBackColorTint:"rgba(255, 255, 255, 0.1)",folderFrontColorTint:"rgba(255, 255, 255, 0.4)"},listFileEntry:{propertyFontSize:14,iconFontSize:"1.1em",iconBorderRadius:5,fontSize:14}},Bt={gridFileEntry:{fileColorTint:"rgba(50, 50, 50, 0.4)",folderBackColorTint:"rgba(50, 50, 50, 0.4)",folderFrontColorTint:"rgba(50, 50, 50, 0.15)"}},Vt={fontSizes:{rootPrimary:13},margins:{rootLayoutMargin:4},toolbar:{size:28,lineHeight:"28px",fontSize:13},gridFileEntry:{fontSize:13},listFileEntry:{propertyFontSize:12,iconFontSize:"1em",fontSize:13}},Kt=function(){return h("(max-width:480px)")},qt=function(e,t){return"repeating-linear-gradient(45deg,"+e+","+e+" 10px,"+t+" 0,"+t+" 20px)"},Gt=function(e){return i.createUseStyles(e)},Wt=function(e){var t={},n=i.createUseStyles((function(n){var r=e(n),o={};return Object.keys(r).map((function(e){var n="chonky-"+e;o["@global ."+n]=r[e],t[e]=n})),o}));return function(){var e=n.apply(void 0,arguments),r={};return Object.keys(t).map((function(e){r[e]=t[e]})),L({},r,e)}},Ut=function(e){return[e,"!important"]},Yt=g.default,Xt=t.memo(t.forwardRef((function(e,n){var r;return Ft(vt.setRawFiles,null!=(r=e.files)?r:gt.rawFiles),Ft(vt.setRawFolderChain,e.folderChain),It(Je,st(e.fileActions,wt.fileActions),st(e.disableDefaultFileActions,wt.disableDefaultFileActions)),It(vt.setExternalFileActionHandler,st(e.onFileAction,wt.onFileAction)),It(vt.setSelectionDisabled,st(e.disableSelection,wt.disableSelection,"boolean")),It(nt,st(e.defaultSortActionId,wt.defaultSortActionId)),It(tt,st(e.defaultFileViewActionId,wt.defaultFileViewActionId,"string")),It(vt.setThumbnailGenerator,st(e.thumbnailGenerator,wt.thumbnailGenerator)),It(vt.setDoubleClickDelay,st(e.doubleClickDelay,wt.doubleClickDelay,"number")),It(vt.setForceEnableOpenParent,st(e.forceEnableOpenParent,wt.forceEnableOpenParent,"boolean")),It(vt.setHideToolbarInfo,st(e.hideToolbarInfo,wt.hideToolbarInfo,"boolean")),It(vt.setDisableDragAndDrop,st(e.disableDragAndDrop,wt.disableDragAndDrop,"boolean")),It(vt.setClearSelectionOnOutsideClick,st(e.clearSelectionOnOutsideClick,wt.clearSelectionOnOutsideClick,"boolean")),function(e){var n=a.useStore(),r=a.useDispatch();t.useImperativeHandle(e,(function(){return{getFileSelection:function(){var e=se(n.getState());return new Set(Object.keys(e))},setFileSelection:function(e,t){void 0===t&&(t=!0);var n=Array.from(e);r(vt.selectFiles({fileIds:n,reset:t}))},requestFileAction:function(e,t){return(n=_().mark((function n(){return _().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",Promise.resolve(r(ot(e,t))));case 1:case"end":return n.stop()}}),n)})),function(){var e=this,t=arguments;return new Promise((function(r,o){var i=n.apply(e,t);function a(e){T(i,r,o,a,l,"next",e)}function l(e){T(i,r,o,a,l,"throw",e)}a(void 0)}))})();var n}}}),[n,r])}(n),null})));Xt.displayName="ChonkyBusinessLogicInner";var Zt=t.memo(Xt);Zt.displayName="ChonkyBusinessLogic";var Qt=function(){return!!t.useContext(n.DndContext).dragDropManager},$t="dnd-chonky-file-entry",Jt={position:"fixed",pointerEvents:"none",zIndex:100,left:0,top:0,width:"100%",height:"100%"},en=function(e,t,n){if(!e||!t||!n)return{display:"none"};var r="translate("+(e.x+(n.x-t.x))+"px, "+(e.y+(n.y-t.y))+"px)";return{transform:r,WebkitTransform:r}},tn=function(){var e=nn(),r=n.useDragLayer((function(e){return{item:e.getItem(),itemType:e.getItemType(),initialCursorOffset:e.getInitialClientOffset(),initialFileOffset:e.getInitialSourceClientOffset(),currentFileOffset:e.getSourceClientOffset(),isDragging:e.isDragging()}})),o=r.item;if(!r.isDragging||r.itemType!==$t||!o.payload)return null;var i=o.payload.selectedFiles.length;return t.createElement("div",{style:Jt},t.createElement("div",{style:en(r.initialCursorOffset,r.initialFileOffset,r.currentFileOffset)},t.createElement("div",{className:e.fileDragPreview},t.createElement("b",null,o.payload.draggedFile.name),i>1&&t.createElement(t.Fragment,null," and ",t.createElement("strong",null,i-1," other file",i-1!=1?"s":"")))))},nn=Wt((function(e){return{fileDragPreview:{boxShadow:"2px 2px 5px "+e.palette.divider,backgroundColor:e.palette.background.default,borderRadius:e.dragLayer.borderRadius,fontSize:e.fontSizes.rootPrimary,color:e.palette.text.primary,padding:e.dragLayer.padding,border:e.dragLayer.border,display:"inline-block"}}})),rn=t.memo((function(e){var n=e.fileActionId,r=a.useDispatch(),o=St(Z,n);return t.useEffect((function(){if(o&&o.hotkeys&&0!==o.hotkeys.length){var e=o.hotkeys.join(","),t=function(e){e.preventDefault(),r(ot(o,void 0))};return v(e,t),function(){return v.unbind(e,t)}}}),[r,o]),null})),on=function(e){var n=e.children,r=a.useDispatch(),o=a.useSelector(X),i=a.useSelector(we),l=a.useSelector(Ee),c=t.useCallback((function(e){l&&!ct(e.target,(function(e){return e.tagName&&"button"===e.tagName.toLowerCase()}))&&r(vt.clearSelection())}),[r,l]),s=t.useMemo((function(){return o.map((function(e){return t.createElement(rn,{key:"file-action-listener-"+e,fileActionId:e})}))}),[o]),u=Qt(),d=function(){var e=a.useDispatch(),n=H(a.useSelector(De));return t.useCallback((function(t){if(n.current&&!t.altKey){t.preventDefault();var r,o=(r=ct(t.target,(function(e){return e.tagName&&"div"===e.tagName.toLowerCase()&&e.dataset&&e.dataset.chonkyFileId})))?r.dataset.chonkyFileId:null;e(ot(pt.OpenFileContextMenu,{clientX:t.clientX,clientY:t.clientY,triggerFileId:o}))}}),[n,e])}(),f=an();return t.createElement(b,{onClickAway:c},t.createElement(y,{className:f.chonkyRoot,onContextMenu:d},!i&&u&&t.createElement(tn,null),s,n||null))},an=Wt((function(e){return{chonkyRoot:{backgroundColor:e.palette.background.paper,border:e.root.borderStyle?e.root.borderStyle+" "+e.palette.divider:void 0,padding:e.margins.rootLayoutMargin,fontSize:e.fontSizes.rootPrimary,color:e.palette.text.primary,touchAction:"manipulation",fontFamily:"sans-serif",flexDirection:"column",boxSizing:"border-box",textAlign:"left",borderRadius:e.root.borderRadius,display:"flex",height:e.root.height,webkitTouchCallout:"none",webkitUserSelect:"none",mozUserSelect:"none",msUserSelect:"none",userSelect:"none"}}})),ln=t.forwardRef((function(s,u){var d,f=s.instanceId,p=s.iconComponent,m=s.children,h=st(s.disableDragAndDrop,wt.disableDragAndDrop,"boolean"),g=st(s.disableDragAndDropProvider,wt.disableDragAndDropProvider,"boolean"),y=st(s.darkMode,wt.darkMode,"boolean"),b=st(s.i18n,wt.i18n),v=t.useMemo((function(){return L({},At,null==b?void 0:b.formatters)}),[b]),x=j((function(){return null!=f?f:l.generate()})),C=Ct(x),S=Kt(),I=t.useMemo((function(){var t={palette:{mode:y?"dark":"light"}};s.muiThemeOptions&&(t=e(t,s.muiThemeOptions));var n=c.createTheme(t),r=e(n,e(e(Ht,y?Bt:{}),s.theme||{}));return S?e(r,Vt):r}),[y,S]),F=t.createElement(t.Fragment,null,t.createElement(Zt,L({ref:u},s)),t.createElement(on,null,m));return t.createElement(o.IntlProvider,L({locale:"en",defaultLocale:"en"},b),t.createElement(Ot.Provider,{value:v},t.createElement(a.Provider,{store:C},t.createElement(i.ThemeProvider,{theme:I},t.createElement(c.StyledEngineProvider,{injectFirst:!0},t.createElement(c.ThemeProvider,{theme:I},t.createElement(Tt.Provider,{value:null!=(d=null!=p?p:wt.iconComponent)?d:kt},h||g?F:t.createElement(n.DndProvider,{backend:r.HTML5Backend},F))))))))}));ln.displayName="FileBrowser";var cn,sn=function(e){var r=e.file,o=e.forceDisableDrop,i=e.includeChildrenDrops,l=H(a.useSelector(J)),c=t.useCallback((function(e,t){if(t.canDrop())return{dropTarget:r}}),[r]),s=t.useCallback((function(e,t){if(o||!V.isDroppable(r)||!t.isOver({shallow:!0})&&!i)return!1;var n=e.payload,a=n.source,c=n.draggedFile,s=n.selectedFiles,u=new Set;u.add(r.id),l.current.map((function(e){e&&u.add(e.id)}));for(var d,f=z([c].concat(s));!(d=f()).done;)if(u.has(d.value.id))return!1;return r.id!==(null==a?void 0:a.id)}),[o,r,i,l]),u=t.useCallback((function(e){return{isOver:e.isOver(),isOverCurrent:e.isOver({shallow:!0}),canDrop:e.canDrop()}}),[]),d=function(){var e=Qt(),r=t.useCallback((function(){return[{},function(){return null}]}),[]);return(e?n.useDrop:r).apply(void 0,arguments)}({accept:$t,drop:c,canDrop:s,collect:u}),f=d[0];return{dndIsOver:f.isOver,dndIsOverCurrent:f.isOverCurrent,dndCanDrop:f.canDrop,drop:d[1]}},un=function(e,n){var r=a.useDispatch(),o=H(a.useSelector(ee));t.useEffect((function(){var t,i=null;return n.dndIsOver&&V.isDndOpenable(e)&&e.id!==(null==(t=o.current)?void 0:t.id)&&(i=setTimeout((function(){return r(ot(ut.OpenFiles,{targetFile:e,files:[e]}))}),1500)),function(){i&&clearTimeout(i)}}),[r,e,n.dndIsOver,o])},dn=t.memo((function(e){var n,r,o=(r=e.maxLength,(n=e.minLength)+Math.floor(Math.random()*Math.floor(r-n))),i="&nbsp;".repeat(o),a=fn();return t.createElement("span",{className:a.textPlaceholder,dangerouslySetInnerHTML:{__html:i}})})),fn=Gt((function(){return{"@keyframes loading-placeholder":{"0%":{opacity:.2},"50%":{opacity:.4},"100%":{opacity:.2}},textPlaceholder:{animationName:"$loading-placeholder",animationIterationCount:"infinite",animationTimingFunction:"linear",animationDuration:"1.5s",backgroundColor:"#ccc",whiteSpace:"nowrap",overflow:"hidden",borderRadius:4,maxWidth:"40%",minWidth:20}}})),pn=function(e){return t.useMemo((function(){return L({role:"listitem"},{"data-test-id":"file-entry","data-chonky-file-id":e?e.id:void 0})}),[e])},mn=function(e,n,r){var o=function(e){return t.useMemo((function(){return e?!0===e.isDir?{icon:exports.ChonkyIconName.folder,colorCode:0}:jt.getWithCheckpoints(e.name,".",!0)||{icon:exports.ChonkyIconName.file,colorCode:32}:{icon:exports.ChonkyIconName.loading,colorCode:0}}),[e])}(e),i=gn(e),a=i.thumbnailUrl,l=i.thumbnailLoading;return t.useMemo((function(){var t=a?Pt[o.colorCode]:Rt[o.colorCode],i=l||!e,c=l?exports.ChonkyIconName.loading:o.icon;return{childrenCount:V.getChildrenCount(e),icon:e&&void 0!==e.icon?e.icon:c,iconSpin:i,thumbnailUrl:a,color:e&&void 0!==e.color?e.color:t,selected:n,focused:!!r}}),[e,r,o,n,l,a])},hn=function(e){var t=null;return e.dndIsOver?t=e.dndCanDrop?exports.ChonkyIconName.dndCanDrop:exports.ChonkyIconName.dndCannotDrop:e.dndIsDragging&&(t=exports.ChonkyIconName.dndDragging),t},gn=function(e){var n=a.useSelector(Fe),r=t.useState(null),o=r[0],i=r[1],l=t.useState(!1),c=l[0],s=l[1],u=t.useRef(0);return t.useEffect((function(){var t=!1;return e&&(n?(0===u.current&&s(!0),u.current++,Promise.resolve().then((function(){return n(e)})).then((function(e){t||(s(!1),e&&"string"==typeof e&&i(e))})).catch((function(e){t||s(!1),B.error('User-defined "thumbnailGenerator" handler threw an error: '+e.message)}))):e.thumbnailUrl&&i(e.thumbnailUrl)),function(){t=!0}}),[e,i,s,n]),{thumbnailUrl:o,thumbnailLoading:c}};exports.CustomVisibilityState=void 0,(cn=exports.CustomVisibilityState||(exports.CustomVisibilityState={}))[cn.Hidden=0]="Hidden",cn[cn.Disabled=1]="Disabled",cn[cn.Default=2]="Default",cn[cn.Active=3]="Active";var yn=function(e){var n=a.useDispatch(),r=St(Z,e);return t.useCallback((function(){return n(ot(r,void 0))}),[n,r])},bn=function(e){var n,r=a.useSelector(te),o=a.useSelector(ye),i=a.useSelector(ve),l=a.useSelector(xe),c=a.useSelector(Ce),s=St(Z,e),u=St(Ie,null==s||null==(n=s.option)?void 0:n.id),d=0===St(he,e);return t.useMemo((function(){var e,t;if(!s)return{icon:null,active:!1,disabled:!0};var n=null!=(e=null==(t=s.button)?void 0:t.icon)?e:null;s.sortKeySelector?n=l===s.id?c===R.ASC?exports.ChonkyIconName.sortAsc:exports.ChonkyIconName.sortDesc:exports.ChonkyIconName.placeholder:s.option&&(n=u?exports.ChonkyIconName.toggleOn:exports.ChonkyIconName.toggleOff);var a=s.id===l,f=s.fileViewConfig===i,p=!!s.option&&!!u,m=!1,h=!1;void 0!==s.customVisibility&&(m=s.customVisibility()===exports.CustomVisibilityState.Disabled,h=s.customVisibility()===exports.CustomVisibilityState.Active);var g=a||f||p||h,y=!!s.requiresSelection&&d||m;return s.id===pt.OpenParentFolder.id&&(y=y||!o&&!V.isOpenable(r)),{icon:n,active:g,disabled:y}}),[r,i,l,c,s,u,d])},vn=t.memo((function(e){var n,r=e.className,o=e.text,i=e.tooltip,a=e.active,l=e.icon,c=e.iconOnly,s=e.onClick,u=e.disabled,d=e.dropdown,f=xn(),p=t.useContext(Tt),m=l||c?t.createElement("div",{className:c?"":f.iconWithText},t.createElement(p,{icon:l||exports.ChonkyIconName.fallbackIcon,fixedWidth:!0})):null,h=Yt(((n={})[null!=r?r:""]=!0,n[f.baseButton]=!0,n[f.iconOnlyButton]=c,n[f.activeButton]=!!a,n));return t.createElement(C,{className:h,onClick:s,title:i||o,disabled:u||!s},m,o&&!c&&t.createElement("span",null,o),d&&o&&!c&&t.createElement("div",{className:f.iconDropdown},t.createElement(p,{icon:exports.ChonkyIconName.dropdown,fixedWidth:!0})))})),xn=Wt((function(e){return{baseButton:{fontSize:Ut(e.toolbar.fontSize),textTransform:Ut("none"),letterSpacing:Ut(0),minWidth:Ut("auto"),lineHeight:e.toolbar.lineHeight,height:e.toolbar.size,paddingBottom:Ut(0),paddingTop:Ut(0),paddingLeft:e.toolbar.buttonPadding,paddingRight:e.toolbar.buttonPadding},iconWithText:{marginRight:8},iconOnlyButton:{width:e.toolbar.size,textAlign:"center"},iconDropdown:{fontSize:"0.7em",marginLeft:2,marginTop:1},activeButton:{color:Ut(e.colors.textActive)}}})),Cn=t.memo((function(e){var n=e.fileActionId,r=St(Z,n),o=yn(n),i=bn(n),a=i.icon,l=i.active,c=i.disabled,s=Mt(r),u=s.buttonName,d=s.buttonTooltip;if(!r)return null;var f=r.button;return f?void 0!==r.customVisibility&&r.customVisibility()===exports.CustomVisibilityState.Hidden?null:t.createElement(vn,{text:u,tooltip:d,icon:a,iconOnly:f.iconOnly,active:l,onClick:o,disabled:c}):null})),Sn=t.memo((function(e){var n,r=e.first,o=e.current,i=e.item,a=i.file,l=i.disabled,c=i.onClick,s=sn({file:a,forceDisableDrop:!a||o}),u=s.dndIsOver,d=s.dndCanDrop,f=s.drop,p=t.useMemo((function(){return{dndIsOver:u,dndCanDrop:d,dndIsDragging:!1}}),[d,u]);un(a,p);var m=hn(p),h=t.useContext(Tt),g=In(p),y=Yt(((n={})[g.baseBreadcrumb]=!0,n[g.disabledBreadcrumb]=l,n[g.currentBreadcrumb]=o,n)),b=a?a.name:"Loading...",v=r&&void 0===(null==a?void 0:a.folderChainIcon)?exports.ChonkyIconName.folder:null==a?void 0:a.folderChainIcon;return t.createElement("div",{className:g.buttonContainer,ref:a?f:null},a&&m&&t.createElement("div",{className:g.dndIndicator},t.createElement(h,{icon:m,fixedWidth:!0})),t.createElement(vn,{icon:v,className:y,text:b,disabled:l,onClick:c}))})),In=Gt((function(e){return{buttonContainer:{position:"relative"},baseBreadcrumb:{color:function(t){var n=e.palette.text.primary;return t.dndIsOver&&(n=t.dndCanDrop?e.dnd.canDropColor:e.dnd.cannotDropColor),Ut(n)}},disabledBreadcrumb:{color:function(){return Ut(e.palette.text.disabled)}},currentBreadcrumb:{textDecoration:Ut("underline")},dndIndicator:{color:function(t){return t.dndCanDrop?e.dnd.canDropColor:e.dnd.cannotDropColor},backgroundColor:function(t){return t.dndCanDrop?e.dnd.canDropMask:e.dnd.cannotDropMask},lineHeight:"calc("+e.toolbar.lineHeight+" - 6px)",transform:"translateX(-50%) translateY(-50%)",borderRadius:e.toolbar.buttonRadius,height:e.toolbar.size-6,width:e.toolbar.size-6,boxSizing:"border-box",position:"absolute",textAlign:"center",left:"50%",top:"50%",zIndex:5}}})),Fn=t.memo((function(){var e,n,r=kn(),o=(e=a.useSelector(J),n=a.useDispatch(),t.useMemo((function(){var t=[];if(!e)return t;for(var r=function(){var r=e[o];t.push({file:r,disabled:!r,onClick:V.isOpenable(r)&&o!==e.length-1?function(){return n(ot(pt.OpenFiles,{targetFile:r,files:[r]}))}:void 0})},o=0;o<e.length;++o)r();return t}),[n,e])),i=t.useMemo((function(){for(var e=[],n=0;n<o.length;++n){var r=t.createElement(Sn,{key:"folder-chain-"+n,first:0===n,current:n===o.length-1,item:o[n]});e.push(r)}return e}),[o]);return t.createElement(y,{className:r.navbarWrapper},t.createElement(y,{className:r.navbarContainer},t.createElement(Cn,{fileActionId:pt.OpenParentFolder.id}),t.createElement(x,{className:r.navbarBreadcrumbs,classes:{separator:r.separator}},i)))})),kn=Wt((function(e){return{navbarWrapper:{paddingBottom:e.margins.rootLayoutMargin},navbarContainer:{display:"flex"},upDirectoryButton:{fontSize:Ut(e.toolbar.fontSize),height:e.toolbar.size,width:e.toolbar.size,padding:"0px !important"},navbarBreadcrumbs:{fontSize:Ut(e.toolbar.fontSize),flexGrow:100},separator:{marginRight:Ut(4),marginLeft:Ut(4)}}})),wn=t.forwardRef((function(e,n){var r,o=e.text,i=e.active,a=e.icon,l=e.onClick,c=e.disabled,s=En(),u=t.useContext(Tt),d=Yt(((r={})[s.baseButton]=!0,r[s.activeButton]=i,r));return t.createElement(k,{ref:n,className:d,onClick:l,disabled:c},a&&t.createElement(I,{className:s.icon},t.createElement(u,{icon:a,fixedWidth:!0})),t.createElement(F,{primaryTypographyProps:{className:s.text}},o))})),En=Wt((function(e){return{baseButton:{lineHeight:Ut(e.toolbar.lineHeight),height:Ut(e.toolbar.size),minHeight:Ut("auto"),minWidth:Ut("auto"),padding:Ut(e.toolbar.buttonPadding)},icon:{fontSize:Ut(e.toolbar.fontSize),minWidth:Ut("auto"),color:Ut("inherit"),marginRight:8},text:{fontSize:Ut(e.toolbar.fontSize)},activeButton:{color:Ut(e.colors.textActive)}}})),Dn=t.forwardRef((function(e,n){var r=e.fileActionId,o=e.onClickFollowUp,i=St(Z,r),a=yn(r),l=bn(r),c=l.icon,s=l.active,u=l.disabled,d=Mt(i).buttonName,f=t.useCallback((function(){a(),o&&o()}),[o,a]);return i&&i.button?void 0!==i.customVisibility&&i.customVisibility()===exports.CustomVisibilityState.Hidden?null:t.createElement(wn,{ref:n,text:d,icon:c,onClick:f,active:s,disabled:u}):null})),Mn=t.memo((function(e){var n,r,i=e.name,a=e.icon,l=e.fileActionIds,c=t.useState(null),s=c[0],u=c[1],d=t.useCallback((function(e){return u(e.currentTarget)}),[u]),f=t.useCallback((function(){return u(null)}),[u]),p=t.useMemo((function(){return l.map((function(e){return t.createElement(Dn,{key:"menu-item-"+e,fileActionId:e,onClickFollowUp:f})}))}),[l,f]),m={text:(n=i,r=o.useIntl(),t.useMemo((function(){return r.formatMessage({id:Et(exports.I18nNamespace.FileActionGroups,n),defaultMessage:n})}),[n,r])),onClick:d,dropdown:!0};a&&(m.icon=a,m.iconOnly=!0,m.text="");var h=Nn();return t.createElement(t.Fragment,null,t.createElement(vn,L({},m)),t.createElement(S,{autoFocus:!0,keepMounted:!0,elevation:2,anchorEl:s,onClose:f,open:Boolean(s),transitionDuration:150,classes:{list:h.dropdownList}},p))})),Nn=Wt((function(){return{dropdownList:{paddingBottom:Ut(0),paddingTop:Ut(0)}}})),An=t.memo((function(){var e=On(),n=a.useSelector(Ue.getDisplayFileIds),r=a.useSelector(de),i=a.useSelector(ae),l=o.useIntl(),c=l.formatMessage({id:Et(exports.I18nNamespace.Toolbar,"visibleFileCount"),defaultMessage:"{fileCount, plural,\n                =0 {# items}\n                one {# item}\n                other {# items}\n            }"},{fileCount:n.length}),s=l.formatMessage({id:Et(exports.I18nNamespace.Toolbar,"selectedFileCount"),defaultMessage:"{fileCount, plural,\n                =0 {}\n                other {# selected}\n            }"},{fileCount:r}),u=l.formatMessage({id:Et(exports.I18nNamespace.Toolbar,"hiddenFileCount"),defaultMessage:"{fileCount, plural,\n                =0 {}\n                other {# hidden}\n            }"},{fileCount:i});return t.createElement("div",{className:e.infoContainer},t.createElement(w,{className:e.infoText,variant:"body1"},c,(s||u)&&t.createElement("span",{className:e.extraInfoSpan},"(",t.createElement("span",{className:e.selectionSizeText},s),s&&u&&", ",t.createElement("span",{className:e.hiddenCountText},u),")")))})),On=Wt((function(e){return{infoContainer:{height:e.toolbar.size,display:"flex"},infoText:{lineHeight:Ut(e.toolbar.lineHeight),fontSize:Ut(e.toolbar.fontSize),marginLeft:Ut(12),height:e.toolbar.size},extraInfoSpan:{marginRight:Ut(8),marginLeft:Ut(8),opacity:.8},selectionSizeText:{color:e.colors.textActive},hiddenCountText:{}}})),Tn=t.memo((function(){var e=o.useIntl().formatMessage({id:Et(exports.I18nNamespace.Toolbar,"searchPlaceholder"),defaultMessage:"Search"}),n=zn(),r=t.useContext(Tt),i=t.useRef(),l=a.useDispatch(),c=a.useSelector(ce),s=t.useState(c),u=s[0],d=s[1],f=function(e,n){var r=t.useState(e),o=r[0],i=r[1];return t.useEffect((function(){var t=setTimeout((function(){i(e)}),50);return function(){clearTimeout(t)}}),[e,50]),[o,i]}(u),p=f[0],m=t.useState(!1),h=m[0],g=m[1];t.useEffect((function(){return l(vt.setFocusSearchInput((function(){i.current&&i.current.focus()}))),function(){l(vt.setFocusSearchInput(null))}}),[l]),t.useEffect((function(){g(!1),l(vt.setSearchString(p))}),[p,l]);var y=t.useCallback((function(e){g(!0),d(e.currentTarget.value)}),[]),b=t.useCallback((function(e){"Escape"===e.key&&(d(""),l(vt.setSearchString("")),i.current&&i.current.blur())}),[l]);return t.createElement(D,{className:n.searchFieldContainer,size:"small",variant:"outlined",value:u,placeholder:e,onChange:y,inputRef:i,InputProps:{onKeyUp:b,startAdornment:t.createElement(E,{className:n.searchIcon,position:"start"},t.createElement(r,{icon:h?exports.ChonkyIconName.loading:exports.ChonkyIconName.search,spin:h})),className:n.searchFieldInput},inputProps:{className:n.searchFieldInputInner}})})),zn=Wt((function(e){return{searchFieldContainer:{height:e.toolbar.size,width:150},searchIcon:{fontSize:"0.9em",opacity:.75},searchFieldInput:{lineHeight:Ut(0),padding:Ut(0),margin:Ut(0),fontSize:Ut(e.toolbar.fontSize),borderRadius:e.toolbar.buttonRadius,height:e.toolbar.size-4,paddingLeft:Ut(8),marginTop:2},searchFieldInputInner:{lineHeight:Ut(e.toolbar.size-4+"px"),fontSize:Ut(e.toolbar.fontSize),height:Ut(e.toolbar.size-4),padding:Ut([0,8,0,0]),margin:Ut(0),"-webkit-appearance":"none"}}})),Ln=t.memo((function(e){var n=e.children,r=_n(),o=a.useSelector(Q),i=t.useMemo((function(){for(var e=[],n=0;n<o.length;++n){var r=o[n],i="toolbar-item-"+("string"==typeof r?r:r.name),a="string"==typeof r?t.createElement(Cn,{key:i,fileActionId:r}):t.createElement(Mn,L({key:i},r));e.push(a)}return e}),[o]),l=a.useSelector(be);return t.createElement("div",{className:r.toolbarWrapper},t.createElement("div",{className:r.toolbarContainer},t.createElement("div",{className:r.toolbarLeft},t.createElement(Tn,null),!l&&t.createElement(An,null),n),t.createElement("div",{className:r.toolbarRight},i)))})),_n=Wt((function(e){return{toolbarWrapper:{},toolbarContainer:{flexWrap:"wrap-reverse",display:"flex"},toolbarLeft:{paddingBottom:e.margins.rootLayoutMargin,flexWrap:"wrap",flexGrow:1e4,display:"flex"},toolbarLeftFiller:{flexGrow:1e4},toolbarRight:{paddingBottom:e.margins.rootLayoutMargin,flexWrap:"wrap",display:"flex"}}})),Rn=function(e){var n=e.width,r=e.height,i=Pn(),a=t.useContext(Tt),l={width:n,height:r},c=o.useIntl().formatMessage({id:Et(exports.I18nNamespace.FileList,"nothingToShow"),defaultMessage:"Nothing to show"});return t.createElement("div",{className:i.fileListEmpty,style:l},t.createElement("div",{className:i.fileListEmptyContent},t.createElement(a,{icon:exports.ChonkyIconName.folderOpen}),"  ",c))},Pn=Wt((function(e){return{fileListEmpty:{color:e.palette.text.disabled,position:"relative",textAlign:"center",fontSize:"1.2em"},fileListEmptyContent:{transform:"translateX(-50%) translateY(-50%)",position:"absolute",left:"50%",top:"50%"}}})),jn=function(e){var n=e.children,r=e.wrapperTag,o=e.passthroughProps,i=e.onSingleClick,l=e.onDoubleClick,c=e.onKeyboardClick,s=e.setFocused,u=function(e,n){var r=a.useSelector(ke),o=t.useRef({clickCount:0,clickTimeout:null});return t.useCallback((function(t){var i={altKey:t.altKey,ctrlKey:t.ctrlKey||t.metaKey,shiftKey:t.shiftKey};o.current.clickCount++,1===o.current.clickCount?(e&&(t.preventDefault(),e(i)),o.current.clickCount=1,o.current.clickTimeout=setTimeout((function(){return o.current.clickCount=0}),r)):2===o.current.clickCount&&(n&&(t.preventDefault(),n(i)),"number"==typeof o.current.clickTimeout&&(clearTimeout(o.current.clickTimeout),o.current.clickTimeout=null,o.current.clickCount=0))}),[r,e,n,o])}(i,l),d=function(e){return t.useCallback((function(t){if(e){var n={enterKey:"Enter"===t.nativeEvent.code,spaceKey:"Space"===t.nativeEvent.code,altKey:t.altKey,ctrlKey:t.ctrlKey,shiftKey:t.shiftKey};(n.spaceKey||n.enterKey)&&(t.preventDefault(),t.stopPropagation(),e(n))}}),[e])}(c),f={onFocus:t.useCallback((function(){return s&&s(!0)}),[s]),onBlur:t.useCallback((function(){return s&&s(!1)}),[s])};(i||l||c)&&(f.onClick=u,f.onKeyDown=d,f.tabIndex=0);var p=L({},f,o);return t.createElement(r,L({},p),n)},Hn=t.memo((function(e){var n=e.file,r=e.className,o=function(e){var n=t.useMemo((function(){var t=[];return V.isHidden(e)&&t.push(exports.ChonkyIconName.hidden),V.isSymlink(e)&&t.push(exports.ChonkyIconName.symlink),V.isEncrypted(e)&&t.push(exports.ChonkyIconName.lock),t}),[e]),r=t.useContext(Tt);return t.useMemo((function(){return n.map((function(e,n){return t.createElement(r,{key:"file-modifier-"+n,icon:e})}))}),[r,n])}(n),i=function(e){return t.useMemo((function(){if(!e)return t.createElement(dn,{minLength:15,maxLength:20});var n,r,o,i=null;return V.isDirectory(e)?n=e.name:(i=null!=(r=e.ext)?r:(o=e.name.split(".")).length?"."+o[o.length-1]:"",n=e.name.substring(0,e.name.length-i.length)),t.createElement(t.Fragment,null,n,i&&t.createElement("span",{className:"chonky-file-entry-description-title-extension"},i))}),[e])}(n),a=Bn();return t.createElement("span",{className:r,title:n?n.name:void 0},o.length>0&&t.createElement("span",{className:a.modifierIcons},o),i)}));Hn.displayName="FileEntryName";var Bn=Gt((function(e){return{modifierIcons:{color:e.palette.text.primary,position:"relative",fontSize:"0.775em",paddingRight:5}}})),Vn=t.memo((function(e){var n=e.file,r=mn(n,e.selected,e.focused),o=Nt(n),i=o.fileModDateString,a=o.fileSizeString,l=Kn(r),c=t.useContext(Tt),s=pn(n);return t.createElement("div",L({className:l.listFileEntry},s),t.createElement("div",{className:l.listFileEntryIcon},t.createElement(c,{icon:r.icon,spin:r.iconSpin,fixedWidth:!0})),t.createElement("div",{className:l.listFileEntryDescription},t.createElement("div",{className:l.listFileEntryName,title:n?n.name:void 0},t.createElement(Hn,{file:n})),t.createElement("div",{className:l.listFileEntryProperties},t.createElement("div",{className:l.listFileEntryProperty},n?null!=i?i:t.createElement("span",null,"—"):t.createElement(dn,{minLength:5,maxLength:15})),t.createElement("div",{className:l.listFileEntryProperty},n?null!=a?a:t.createElement("span",null,"—"):t.createElement(dn,{minLength:10,maxLength:20})))),t.createElement("div",{className:"chonky-file-entry-outline"}),t.createElement("div",{className:"chonky-file-entry-selection"}))})),Kn=Gt((function(e){return{listFileEntry:{fontSize:e.listFileEntry.fontSize,alignItems:"center",position:"relative",display:"flex",height:"100%"},listFileEntryIcon:{backgroundColor:function(e){return e.color},boxShadow:"inset rgba(255, 255, 255, 0.5) 0 0 0 999px",borderRadius:e.listFileEntry.iconBorderRadius,fontSize:e.listFileEntry.iconFontSize,color:"#fff",padding:8},listFileEntryDescription:{flexDirection:"column",display:"flex",flexGrow:1},listFileEntryName:{padding:[0,8,4,8]},listFileEntryProperties:{fontSize:e.listFileEntry.propertyFontSize,flexDirection:"row",display:"flex"},listFileEntryProperty:{padding:[0,8],opacity:.4}}})),qn=t.memo((function(e){var o=e.file,i=e.children,l=function(e){var o=function(e){var o=a.useStore(),i=H(e),l=t.useCallback((function(){var e=o.getState();return{sourceInstanceId:W(e),source:ee(e),draggedFile:i.current,selectedFiles:pe(e)}}),[o,i]),c=a.useDispatch(),s=t.useCallback((function(){return V.isDraggable(i.current)}),[i]),u=t.useCallback((function(){var e={type:$t,payload:l()};return c(ot(pt.StartDragNDrop,e.payload)),e}),[c,l]),d=t.useCallback((function(e,t){var n=t.getDropResult();V.isDraggable(e.payload.draggedFile)&&n&&n.dropTarget&&c(ot(pt.EndDragNDrop,L({},e.payload,{destination:n.dropTarget,copy:"copy"===n.dropEffect})))}),[c]),f=t.useCallback((function(e){return{isDragging:e.isDragging()}}),[]),p=function(){var e=Qt(),r=t.useCallback((function(){return[{},function(){return null},function(){return null}]}),[]);return(e?n.useDrag:r).apply(void 0,arguments)}({item:u,type:$t,canDrag:s,end:d,collect:f}),m=p[0].isDragging,h=p[1],g=p[2];return t.useEffect((function(){g(r.getEmptyImage(),{captureDraggingState:!0})}),[g]),{dndIsDragging:m,drag:h}}(e),i=o.dndIsDragging,l=o.drag,c=sn({file:e}),s=c.dndIsOver,u=c.dndCanDrop;return{drop:c.drop,drag:l,dndState:t.useMemo((function(){return{dndIsDragging:i,dndIsOver:s,dndCanDrop:u}}),[u,i,s])}}(o),c=l.drop,s=l.drag,u=l.dndState;un(o,u);var d=Gn();return t.createElement("div",{ref:c,className:d.fillParent},t.createElement("div",{ref:V.isDraggable(o)?s:null,className:d.fillParent},i(u)))})),Gn=Gt((function(){return{fillParent:{height:"100%"}}})),Wn=t.memo((function(e){var n=e.className,r=e.thumbnailUrl,o=r?{backgroundImage:"url('"+r+"')"}:{},i=Un();return t.createElement("div",{className:g([n,i.fileThumbnail]),style:o})}));Wn.displayName="FileThumbnail";var Un=Wt((function(){return{fileThumbnail:{backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundSize:"contain"}}})),Yn=t.memo((function(e){var n,r=e.className,o=e.dndState,i=hn(o),a=Xn(o),l=t.useContext(Tt);if(!i)return null;var c=Yt(((n={})[a.dndIndicator]=!0,n[r]=!0,n));return t.createElement("div",{className:c},t.createElement(l,{icon:i}))})),Xn=Gt((function(e){return{dndIndicator:{color:function(t){return t.dndIsOver?t.dndCanDrop?e.dnd.canDropColor:e.dnd.cannotDropColor:"#000"},boxSizing:"border-box",position:"absolute",fontSize:"1.2em",opacity:.6,padding:6,"&:before":{borderBottom:"50px solid transparent",borderLeft:"50px solid #fff",position:"absolute",content:'""',zIndex:-1,left:0,top:0}}}})),Zn=t.memo((function(e){var n,r=e.className,o=e.entryState,i=e.dndState,a=Qn(o),l=Jn(o),c=er(o),s=Yt(((n={})[a.previewFile]=!0,n[r||""]=!!r,n));return t.createElement("div",{className:s},t.createElement("div",{className:a.folderBackSideMid},t.createElement("div",{className:a.folderBackSideTop}),t.createElement("div",{className:a.folderFrontSide},t.createElement(Yn,{className:l.dndIndicator,dndState:i}),t.createElement("div",{className:Yt([l.fileIcon,a.fileIcon])},o.childrenCount),t.createElement("div",{className:c.selectionIndicator}),t.createElement(Wn,{className:l.thumbnail,thumbnailUrl:o.thumbnailUrl}))))}));Zn.displayName="GridEntryPreviewFolder";var Qn=Gt((function(e){return{previewFile:{borderRadius:e.gridFileEntry.borderRadius,position:"relative",overflow:"hidden"},folderBackSideTop:{backgroundColor:function(e){return e.color},boxShadow:function(t){var n=e.gridFileEntry.folderBackColorTint;return t.focused?n="rgba(0, 0, 0, 0.3)":t.selected&&(n="rgba(0, 153, 255, .4)"),"inset "+n+" 0 0 0 999px"},borderTopLeftRadius:e.gridFileEntry.borderRadius,borderTopRightRadius:10,position:"absolute",right:"60%",height:13,top:-10,left:0,"&:after":{borderRightColor:e.palette.background.paper,borderTopColor:e.palette.background.paper,borderBottomColor:"transparent",borderLeftColor:"transparent",borderWidth:[0,15,10,0],borderStyle:"solid",position:"absolute",display:"block",content:'""',right:0,top:0}},folderBackSideMid:{backgroundColor:function(e){return e.color},boxShadow:function(t){var n=e.gridFileEntry.folderBackColorTint;return t.focused?n="rgba(0, 0, 0, 0.3)":t.selected&&(n="rgba(0, 153, 255, .4)"),"inset "+n+" 0 0 0 999px"},borderTopRightRadius:e.gridFileEntry.borderRadius,position:"absolute",bottom:0,right:0,left:0,top:10},folderFrontSide:{boxShadow:function(t){var n=[];return t.focused&&n.push("inset rgba(0, 0, 0, 1) 0 0 0 3px"),t.selected&&n.push("inset rgba(0, 153, 255, .65) 0 0 0 3px"),n.push("inset "+e.gridFileEntry.folderFrontColorTint+" 0 0 0 999px"),n.join(", ")},backgroundColor:function(e){return e.color},borderRadius:e.gridFileEntry.borderRadius,position:"absolute",overflow:"hidden",bottom:0,right:0,left:0,top:10},fileIcon:{fontSize:Ut(e.gridFileEntry.childrenCountSize)}}})),$n=t.memo((function(e){var n,r=e.className,o=e.entryState,i=e.dndState,a=Jn(o),l=er(o),c=t.useContext(Tt),s=Yt(((n={})[a.previewFile]=!0,n[r||""]=!!r,n));return t.createElement("div",{className:s},t.createElement(Yn,{className:a.dndIndicator,dndState:i}),t.createElement("div",{className:a.fileIcon},t.createElement(c,{icon:o.icon,spin:o.iconSpin})),t.createElement("div",{className:l.selectionIndicator}),t.createElement(Wn,{className:a.thumbnail,thumbnailUrl:o.thumbnailUrl}))}));$n.displayName="GridEntryPreviewFile";var Jn=Gt((function(e){return{previewFile:{boxShadow:function(t){var n=[];return t.selected&&n.push("inset rgba(0,153,255, .65) 0 0 0 3px"),t.focused&&n.push("inset rgba(0, 0, 0, 1) 0 0 0 3px"),n.push("inset "+e.gridFileEntry.fileColorTint+" 0 0 0 999px"),n.join(", ")},backgroundColor:function(e){return e.color},borderRadius:e.gridFileEntry.borderRadius,position:"relative",overflow:"hidden"},dndIndicator:{zIndex:14},fileIcon:{transform:"translateX(-50%) translateY(-50%)",fontSize:e.gridFileEntry.iconSize,opacity:function(e){return e.thumbnailUrl&&!e.focused?0:1},color:function(t){return t.focused?e.gridFileEntry.iconColorFocused:e.gridFileEntry.iconColor},position:"absolute",left:"50%",zIndex:12,top:"50%"},thumbnail:{borderRadius:e.gridFileEntry.borderRadius,position:"absolute",zIndex:6,bottom:5,right:5,left:5,top:5}}})),er=Gt((function(){return{selectionIndicator:{display:function(e){return e.selected?"block":"none"},background:"repeating-linear-gradient(45deg,rgba(0,153,255,.14),rgba(0,153,255,.14) 10px,rgba(0,153,255,.25) 0,rgba(0,153,255,.25) 20px)",backgroundColor:"rgba(0, 153, 255, .14)",position:"absolute",height:"100%",width:"100%",zIndex:10},focusIndicator:{display:function(e){return e.focused?"block":"none"},boxShadow:"inset rgba(0, 0, 0, 1) 0 0 0 2px",position:"absolute",height:"100%",width:"100%",zIndex:11}}})),tr=t.memo((function(e){var n,r=e.file,o=e.selected,i=e.focused,a=e.dndState,l=V.isDirectory(r),c=mn(r,o,i),s=nr(c),u=pn(r),d=Yt(((n={})[s.gridFileEntry]=!0,n));return t.createElement("div",L({className:d},u),t.createElement(l?Zn:$n,{className:s.gridFileEntryPreview,entryState:c,dndState:a}),t.createElement("div",{className:s.gridFileEntryNameContainer},t.createElement(Hn,{className:s.gridFileEntryName,file:r})))}));tr.displayName="GridEntry";var nr=Gt((function(e){return{gridFileEntry:{flexDirection:"column",display:"flex",height:"100%"},gridFileEntryPreview:{flexGrow:1},gridFileEntryNameContainer:{fontSize:e.gridFileEntry.fontSize,wordBreak:"break-word",textAlign:"center",paddingTop:5},gridFileEntryName:{backgroundColor:function(e){return e.selected?"rgba(0,153,255, .25)":"transparent"},textDecoration:function(e){return e.focused?"underline":"none"},borderRadius:3,padding:[2,4]}}})),rr=t.memo((function(e){var n=e.file,r=e.dndState,o=mn(n,e.selected,e.focused),i=hn(r),a=Nt(n),l=a.fileModDateString,c=a.fileSizeString,s=t.useMemo((function(){return{entryState:o,dndState:r}}),[r,o]),u=or(s),d=er(o),f=t.useContext(Tt),p=pn(n);return t.createElement("div",L({className:u.listFileEntry},p),t.createElement("div",{className:d.focusIndicator}),t.createElement("div",{className:Yt([d.selectionIndicator,u.listFileEntrySelection])}),t.createElement("div",{className:u.listFileEntryIcon},t.createElement(f,{icon:null!=i?i:o.icon,spin:!i&&o.iconSpin,fixedWidth:!0})),t.createElement("div",{className:u.listFileEntryName,title:n?n.name:void 0},t.createElement(Hn,{file:n})),t.createElement("div",{className:u.listFileEntryProperty},n?null!=l?l:t.createElement("span",null,"—"):t.createElement(dn,{minLength:5,maxLength:15})),t.createElement("div",{className:u.listFileEntryProperty},n?null!=c?c:t.createElement("span",null,"—"):t.createElement(dn,{minLength:10,maxLength:20})))})),or=Gt((function(e){return{listFileEntry:{boxShadow:"inset "+e.palette.divider+" 0 -1px 0",fontSize:e.listFileEntry.fontSize,color:function(t){var n=t.dndState;return n.dndIsOver?n.dndCanDrop?e.dnd.canDropColor:e.dnd.cannotDropColor:"inherit"},alignItems:"center",position:"relative",display:"flex",height:"100%"},listFileEntrySelection:{opacity:.6},listFileEntryIcon:{color:function(t){var n=t.dndState;return n.dndIsOver?n.dndCanDrop?e.dnd.canDropColor:e.dnd.cannotDropColor:t.entryState.color},fontSize:e.listFileEntry.iconFontSize,boxSizing:"border-box",padding:[2,4],zIndex:20},listFileEntryName:{textOverflow:"ellipsis",boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",flex:"1 1 300px",paddingLeft:8,zIndex:20},listFileEntryProperty:{fontSize:e.listFileEntry.propertyFontSize,boxSizing:"border-box",whiteSpace:"nowrap",overflow:"hidden",flex:"0 1 150px",padding:[2,8],zIndex:20}}})),ir={dndIsDragging:!1,dndIsOver:!1,dndCanDrop:!1},ar=t.memo((function(e){var n,r=e.fileId,o=e.displayIndex,i=e.fileViewMode,l=lr(),c=St(oe,r),s=St(fe,r),u=a.useSelector(we),d=function(e,n){var r=a.useDispatch(),o=t.useCallback((function(t,o){e&&r(ot(pt.MouseClickFile,{clickType:o,file:e,fileDisplayIndex:n,altKey:t.altKey,ctrlKey:t.ctrlKey,shiftKey:t.shiftKey}))}),[r,e,n]),i=t.useCallback((function(t){e&&r(ot(pt.KeyboardClickFile,{file:e,fileDisplayIndex:n,enterKey:t.enterKey,spaceKey:t.spaceKey,altKey:t.altKey,ctrlKey:t.ctrlKey,shiftKey:t.shiftKey}))}),[r,e,n]);return{onSingleClick:t.useCallback((function(e){return o(e,"single")}),[o]),onDoubleClick:t.useCallback((function(e){return o(e,"double")}),[o]),onKeyboardClick:i}}(c,o),f=t.useState(!1),p=f[0],m=f[1],h=L({wrapperTag:"div",passthroughProps:{className:l.fileEntryClickableWrapper}},V.isClickable(c)?d:void 0,{setFocused:m}),g={file:c,selected:s,focused:p};return n=i===exports.FileViewMode.List?rr:i===exports.FileViewMode.Compact?Vn:tr,u?t.createElement(jn,L({},h),t.createElement(n,L({},g,{dndState:ir}))):t.createElement(qn,{file:c},(function(e){return t.createElement(jn,L({},h),t.createElement(n,L({},g,{dndState:e})))}))}));ar.displayName="SmartFileEntry";var lr=Wt((function(){return{fileEntryClickableWrapper:{outline:"none !important",position:"relative",height:"100%"}}})),cr=function(e,t,n,r){var o,i,a=r?5:8,l=void 0!==window.orientation||-1!==navigator.userAgent.indexOf("IEMobile")?0:18;return r?i=(e-a-l)/(o=2):(i=n.entryWidth,o=Math.max(1,Math.floor((e-l)/(i+a)))),{rowCount:Math.ceil(t/o),columnCount:o,gutter:a,rowHeight:n.entryHeight,columnWidth:i}},sr=t.memo((function(e){var n=e.width,r=e.height,o=a.useSelector(ve),i=a.useSelector(Ue.getDisplayFileIds),l=t.useMemo((function(){return i.length}),[i]),c=t.useRef(),s=Kt(),u=t.useState(cr(n,l,o,s)),d=u[0],f=u[1],p=t.useRef(d);t.useEffect((function(){var e=p.current,t=cr(n,l,o,s);p.current=t,c.current&&(e.rowCount!==t.rowCount&&c.current.resetAfterRowIndex(Math.min(e.rowCount,t.rowCount)-1),e.columnCount!==t.columnCount&&c.current.resetAfterColumnIndex(Math.min(e.columnCount,t.rowCount)-1),e.columnWidth!==t.columnWidth&&c.current.resetAfterIndices({columnIndex:0,rowIndex:0})),f(t)}),[f,p,s,n,o,l]);var m=t.useMemo((function(){var e=p;return{getColumnWidth:function(t){return e.current.columnWidth+(t===e.current.columnCount-1?0:e.current.gutter)},getRowHeight:function(t){return e.current.rowHeight+(t===e.current.rowCount-1?0:e.current.gutter)}}}),[p]),h=H(a.useSelector(Ue.getDisplayFileIds)),g=t.useCallback((function(e){var t,n=e.rowIndex*p.current.columnCount+e.columnIndex;return null!=(t=h.current[n])?t:"loading-file-"+n}),[p,h]),y=t.useCallback((function(e){var n=e.rowIndex*p.current.columnCount+e.columnIndex,r=i[n];if(void 0===i[n])return null;var a=L({},e.style,{paddingRight:e.columnIndex===p.current.columnCount-1?0:p.current.gutter,paddingBottom:e.rowIndex===p.current.rowCount-1?0:p.current.gutter,boxSizing:"border-box"});return t.createElement("div",{style:a},t.createElement(ar,{fileId:null!=r?r:null,displayIndex:n,fileViewMode:o.mode}))}),[i,o.mode]),b=ur();return t.useMemo((function(){return t.createElement(N.VariableSizeGrid,{ref:c,className:b.gridContainer,estimatedRowHeight:d.rowHeight+d.gutter,rowHeight:m.getRowHeight,estimatedColumnWidth:d.columnWidth+d.gutter,columnWidth:m.getColumnWidth,columnCount:d.columnCount,height:r,rowCount:d.rowCount,width:n,itemKey:g},y)}),[b.gridContainer,d.rowHeight,d.gutter,d.columnWidth,d.columnCount,d.rowCount,m.getRowHeight,m.getColumnWidth,r,n,g,y])})),ur=Wt((function(){return{gridContainer:{}}})),dr=t.memo((function(e){var n=e.width,r=e.height,o=a.useSelector(ve),i=t.useRef(),l=a.useSelector(Ue.getDisplayFileIds),c=H(l),s=t.useCallback((function(e){var t;return null!=(t=c.current[e])?t:"loading-file-"+e}),[c]),u=fr();return t.useMemo((function(){return t.createElement(N.FixedSizeList,{ref:i,className:u.listContainer,itemSize:o.entryHeight,height:r,itemCount:l.length,width:n,itemKey:s},(function(e){var n;return t.createElement("div",{style:e.style},t.createElement(ar,{fileId:null!=(n=l[e.index])?n:null,displayIndex:e.index,fileViewMode:exports.FileViewMode.List}))}))}),[u.listContainer,o.entryHeight,r,l,n,s])})),fr=Gt((function(e){return{listContainer:{borderTop:"solid 1px "+e.palette.divider}}})),pr=t.memo((function(e){var n=a.useSelector(Ue.getDisplayFileIds),r=a.useSelector(ve),o=a.useSelector(ee),i=sn({file:o}),l=i.drop,c=i.dndCanDrop,s=i.dndIsOverCurrent,u=t.useMemo((function(){return{dndCanDrop:c,dndIsOverCurrent:s}}),[c,s]),d=mr(u),f=hr(r),p=e.onScroll,m=t.useCallback((function(e){var o=e.width,i=e.height;return 0===n.length?t.createElement(Rn,{width:o,height:r.entryHeight}):r.mode===exports.FileViewMode.List?t.createElement(dr,{width:o,height:i}):t.createElement(sr,{width:o,height:i})}),[n,r]),h=t.useContext(Tt);return t.createElement("div",{onScroll:p,ref:l,className:Yt([f.fileListWrapper,d.fileListWrapper]),role:"list"},t.createElement("div",{className:d.dndDropZone},t.createElement("div",{className:d.dndDropZoneIcon},t.createElement(h,{icon:c?exports.ChonkyIconName.dndCanDrop:exports.ChonkyIconName.dndCannotDrop}))),t.createElement(M,{disableHeight:!1},m))}));pr.displayName="FileList";var mr=Gt((function(e){return{fileListWrapper:{minHeight:pt.EnableGridView.fileViewConfig.entryHeight+2,background:function(t){return t.dndIsOverCurrent&&t.dndCanDrop?t.dndCanDrop?qt(e.dnd.fileListCanDropMaskOne,e.dnd.fileListCanDropMaskTwo):qt(e.dnd.fileListCannotDropMaskOne,e.dnd.fileListCannotDropMaskTwo):"none"}},dndDropZone:{display:function(e){return e.dndIsOverCurrent&&e.dndCanDrop?"block":"none"},borderRadius:e.gridFileEntry.borderRadius,pointerEvents:"none",position:"absolute",height:"100%",width:"100%",zIndex:2},dndDropZoneIcon:{backgroundColor:function(t){return t.dndCanDrop?e.dnd.canDropMask:e.dnd.cannotDropMask},color:function(t){return t.dndCanDrop?e.dnd.canDropColor:e.dnd.cannotDropColor},borderRadius:e.gridFileEntry.borderRadius,transform:"translateX(-50%) translateY(-50%)",position:"absolute",textAlign:"center",lineHeight:"60px",fontSize:"2em",left:"50%",height:60,top:"50%",width:60}}})),hr=Wt((function(){return{fileListWrapper:{height:"100%",maxHeight:"100%"}}})),gr=t.memo((function(){var e=a.useDispatch();t.useEffect((function(){return e(vt.setContextMenuMounted(!0)),function(){e(vt.setContextMenuMounted(!1))}}),[e]);var n=o.useIntl().formatMessage({id:Et(exports.I18nNamespace.FileContextMenu,"browserMenuShortcut"),defaultMessage:"Browser menu: {shortcut}"},{shortcut:t.createElement("strong",null,"Alt + Right Click")}),r=a.useSelector(Me),i=a.useSelector($),l=function(){var e=a.useDispatch();return t.useCallback((function(){return e(vt.hideContextMenu())}),[e])}(),c=t.useMemo((function(){for(var e=[],n=function(){var n=i[r];"string"==typeof n?e.push(t.createElement(Dn,{key:"context-menu-item-"+n,fileActionId:n,onClickFollowUp:l})):n.fileActionIds.map((function(r){return e.push(t.createElement(Dn,{key:"context-menu-item-"+n.name+"-"+r,fileActionId:r,onClickFollowUp:l}))}))},r=0;r<i.length;++r)n();return e}),[i,l]),s=t.useMemo((function(){return r?{top:r.mouseY,left:r.mouseX}:void 0}),[r]),u=yr();return t.createElement(S,{elevation:2,disablePortal:!0,onClose:l,transitionDuration:150,open:!!r,anchorPosition:s,anchorReference:"anchorPosition",classes:{list:u.contextMenuList}},c,t.createElement(A,{component:"div",className:u.browserMenuTooltip},n))})),yr=Wt((function(){return{contextMenuList:{paddingBottom:Ut(0),paddingTop:Ut(0)},browserMenuTooltip:{lineHeight:Ut("30px"),fontSize:Ut("0.7em")}}})),br=t.memo(t.forwardRef((function(e,n){var r,o=e.onScroll;return t.createElement(ln,L({ref:n},e),null!=(r=e.folderChain)&&r.length?t.createElement(Fn,null):void 0,t.createElement(Ln,null),t.createElement(pr,{onScroll:o}),t.createElement(gr,null))})));br.displayName="FullFileBrowser";var vr=function(e,n){return t.useMemo((function(){for(var t=e[n],r=[t],o=t.parentId;o;){var i=e[o];if(!i)break;r.unshift(i),o=i.parentId}return r}),[n,e])},xr=function(e,n){return t.useMemo((function(){return e[n].childrenIds.map((function(t){return e[t]}))}),[n,e])},Cr=function(e,n){var r=t.useState(e),o=r[0],i=r[1],a=t.useState(n),l=a[0],c=a[1],s=t.useCallback((function(){i(e),c(n)}),[e,n]),u=t.useCallback((function(e,t,n){return i((function(r){var o=L({},r),i=new Set(e.map((function(e){return e.id}))),a=t.childrenIds.filter((function(e){return!i.has(e)}));o[t.id]=L({},t,{childrenIds:a,childrenCount:a.length});var l=[].concat(n.childrenIds,e.map((function(e){return e.id})));return o[n.id]=L({},n,{childrenIds:l,childrenCount:l.length}),e.forEach((function(e){o[e.id]=L({},e,{parentId:n.id})})),o}))}),[]);return{fileMap:o,currentFolderId:l,methods:t.useMemo((function(){return{setFileMap:i,setCurrentFolderId:c,resetFileMap:s,moveFiles:u}}),[i,c,s,u])}},Sr=function(e){return t.useCallback((function(t){if(t.id===pt.OpenFiles.id){var n=t.payload,r=n.targetFile,o=null!=r?r:n.files[0];o&&V.isDirectory(o)&&e.setCurrentFolderId(o.id)}else t.id===pt.MoveFiles.id&&e.moveFiles(t.payload.files,t.payload.source,t.payload.destination)}),[e])},Ir={__proto__:null,useFileActionHandler:Sr,useFileMap:function(e){var t=Cr(e.baseFileMap,e.initialFolderId),n=t.fileMap,r=t.currentFolderId,o=t.methods;return{data:{fileMap:n,currentFolderId:r,folderChain:vr(n,r),files:xr(n,r)},methods:o,fileActionHandler:Sr(o)}},useFileMapMethods:Cr,useFiles:xr,useFolderChain:vr};exports.ChonkyActions=pt,exports.ChonkyDndFileEntryType=$t,exports.ChonkyIconContext=Tt,exports.DefaultFileActions=ht,exports.FileBrowser=ln,exports.FileContextMenu=gr,exports.FileHelper=V,exports.FileList=pr,exports.FileNavbar=Fn,exports.FileToolbar=Ln,exports.FullFileBrowser=br,exports.OptionIds=q,exports.defaultFormatters=At,exports.defineFileAction=lt,exports.fileMap=Ir,exports.getActionI18nId=Dt,exports.getFileData=Ye,exports.getI18nId=Et,exports.getIsFileSelected=Xe,exports.getSelectedFiles=Ze,exports.getSelectedFilesForAction=Qe,exports.makeGlobalChonkyStyles=Wt,exports.reduxActions=vt,exports.rootReducer=xt,exports.selectCleanFileIds=re,exports.selectClearSelectionOnOutsideClick=Ee,exports.selectContextMenuConfig=Me,exports.selectContextMenuItems=$,exports.selectContextMenuMounted=De,exports.selectContextMenuTriggerFile=Ne,exports.selectCurrentFolder=ee,exports.selectDisableSelection=ge,exports.selectDoubleClickDelay=ke,exports.selectExternalFileActionHandler=U,exports.selectFileActionData=Z,exports.selectFileActionIds=X,exports.selectFileActionMap=Y,exports.selectFileData=oe,exports.selectFileMap=ne,exports.selectFileViewConfig=ve,exports.selectFocusSearchInput=le,exports.selectFolderChain=J,exports.selectForceEnableOpenParent=ye,exports.selectHiddenFileCount=ae,exports.selectHiddenFileIdMap=ie,exports.selectHideToolbarInfo=be,exports.selectInstanceId=W,exports.selectIsDnDDisabled=we,exports.selectIsFileSelected=fe,exports.selectOptionMap=Se,exports.selectOptionValue=Ie,exports.selectParentFolder=te,exports.selectRawFiles=function(e){return e.rawFiles},exports.selectSearchString=ce,exports.selectSelectedFileIds=ue,exports.selectSelectedFiles=pe,exports.selectSelectedFilesForAction=me,exports.selectSelectedFilesForActionCount=he,exports.selectSelectionMap=se,exports.selectSelectionSize=de,exports.selectSortActionId=xe,exports.selectSortOrder=Ce,exports.selectThumbnailGenerator=Fe,exports.selectToolbarItems=Q,exports.selectors=Ue,exports.setChonkyDefaults=function(e){for(var t=0,n=Object.keys(wt);t<n.length;t++){var r=n[t];r in e&&(wt[r]=e[r])}},exports.thunkDispatchFileAction=rt,exports.thunkRequestFileAction=ot,exports.useChonkyStore=Ct,exports.useDTE=It,exports.useParamSelector=St,exports.usePropReduxUpdate=Ft;
//# sourceMappingURL=chonky.cjs.production.min.js.map
